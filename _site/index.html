
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>snorlax's Homepage</title>
    
    <meta name="author" content="Xinzheng Zhang">

    <!-- Enable responsive viewport -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le styles -->
    <link href="/assets/themes/twitter/bootstrap/css/bootstrap.2.2.2.min.css" rel="stylesheet">
    <link href="/assets/themes/twitter/css/style.css?body=1" rel="stylesheet" type="text/css" media="all">
    <link href="/assets/themes/twitter/css/pygments.css?body=1" rel="stylesheet" type="text/css" media="all">
    <!-- Le fav and touch icons -->
  <!-- Update these with your own images
    <link rel="shortcut icon" href="images/favicon.ico">
    <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
  -->

    <!-- atom & rss feed -->
    <link href="" type="application/atom+xml" rel="alternate" title="Sitewide ATOM Feed">
    <link href="/rss.xml" type="application/rss+xml" rel="alternate" title="Sitewide RSS Feed">

  </head>

  <body>
    <div class="navbar">
      <div class="navbar-inner">
        <div class="container-narrow">
          <a class="brand" href="/">Snorlax's blog</a>
          <ul class="nav">
            
            
            


  
    
      
      	
      	<li><a href="/about.html">About me</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/archive.html">Archives</a></li>
      	
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  




          </ul>
        </div>
      </div>
    </div>
    <div class="container_wrapper">
      <div class="container-narrow">
        <div class="content">
          <!-- <ul class="listing"> -->

<div class="page-header">
  <h3><a href="/gossip/2014/06/14/four-years-in-dut">four years in dut </a></h3>
  <div class="date">
    <span>14 June 2014</span>
  </div>
</div>

<div class="row-fluid post-full">
  <div class="span12">
    <div class="content">
      <h4>大一</h4>

<ul>
<li>当初考到dut的初衷或许就其实是一个错误、不过错中对的那一点就是我选择了一个我喜欢的专业、选择到了我的爱好。
说实话这是一个学术氛围浓厚却相对轻技术的地方、但我至少值得庆幸了的是我知道了cippus、加入了软件组、从做的acm开始强化自己的编程能力、从周边了解技术是什么样、至少知道了这条路该怎么走。
这里要感谢lw学长、带我入了门、让我知道这个程序的世界长的是什么样子。
这一年我还跟高中一样、打游戏、写作业、其中一点比较影响的或许应该就是包括所有的作业我都强迫自己不在windows上而用*nix上去实现、也是这点为我打下会努力的去看各种开源的东西的基础吧。</li>
</ul>

<h4>大二</h4>

<ul>
<li>到了大二已经放弃了对大学的一切原有的曾经的憧憬、放弃了上课、开始往技术之路无限的深钻下去。整个大二一整年也应该是我彻底转变的一年。
开始强迫自己看一些很厉害的书、从原理开始自己去写自己去尝试所有各种好玩的东西、学习了python、看到好玩的未知的算法会去实现、看到好玩的网络攻击会去尝试、从最基本最白痴的东西开始写。
想想这些总是和爱好兴趣是密不可分的。</li>
<li>其中穿插着也就是软件组了。其实虽然从大一进入软件组、但是那个时候对这个组其实并没有什么很深的感觉、从现在的角度来回想也的确如此、因为大学就是一个
提供给你资源提供给你自学资源(包括身边的同学)的地方！到了大二小学期、我也成为了软件组组长、我也就开始另一方面的开始锻炼自己梳理讲技术的能力了。开始把这一整年自学到的所有的东西进行了一次
系统的梳理、周周的沙龙把自己的所理解都讲出来、虽然那个时候知道自己很菜、说话也很不流利、但是这或许就是锻炼。也是我又需要感谢cippus的地方。</li>
<li>其中一小段给老师打工的经历、现在想想也是帮助我认清这个世界的大部分人对编程的态度、对自己的编程能力从玩玩到真的写出来点什么的过度吧。当然也不想黑什么自己得没得到自己该得到的什么、毕竟当时
的自己只是一个外包的员工罢了。</li>
</ul>

<h4>大三上</h4>

<ul>
<li>大三或许就是大二的一个延续、开始把上层虚的东西从底层开始更加务实，结合给新招进来大一的组员的技术例会、同时巩固自己的基础水平。从一个组长的角度来说我觉得我挺失败的，个人认为还是挺失败的
、虽然说我努力的准备着每次技术沙龙、试着从最底层也是最不抽象的东西去开始解释一切一切、但是也或许是过份的枯燥没有培养出大一新生对编程的爱、也导致后文会说到的结果吧……
大三下然后为了开始实习，开始刷codeforces开始看算法导论，开始系统的完整填备这一个空缺。开始投简历、开始面试……</li>
</ul>

<h4>大三下(百度)</h4>

<ul>
<li>六月份开始去百度知道实习、当时的我应该还是比较迷茫的或许想什么都没有想好、反正就是想着baidu也算bat一家而且也是开发ios、也算对口就去实习玩玩吧。心态导致结果，所有人都说的百度苦我没感受到
说到的baidu技术强我也没感受到、唯一真真切切感受到的或许就是一整套敏捷的软件工程的流程。这一点在质量保证上等等或许还是很有用的、但是总是感觉付出远大于结果。当然在大厂来说安全稳定性才是最重要的那也是毋庸置疑的。
其实我一直不喜欢加班、更加讨厌baidu这种快到晚上才开始干活然后看起来是加班加的累死累活的这种状态。我也算是经过两次小黑屋封闭开发，也过了一整个月六天工作的过来，但就算在这种情况下我还是认为效率的极其低下的。
然后到了10月份我离职了、我应该换一家去看看。</li>
</ul>

<h4>火花</h4>

<ul>
<li>离职之后我在北京的国家图书馆泡了半个月，继续去看书、写程序去接触更多的东西、一点就是继续去投简历了。当时的想法就是要么去做游戏要么继续互联网公司。也的确我都拿到了盛大和火花的offer。
去盛大转了一圈或许这个地方还是不适合我吧。也让我大概断了自己去做游戏的最后跟信念吧、然后就开始加入了火花。</li>
<li>小公司、真的很棒。说实话个人感觉百度的将近4个月可能真的还比不上在这的半个月学到的多，在这我知道了什么叫做不浪费时间、整天的满负荷工作，当除了开发工作包括各种其他在百度都需要向老大请示的所有细节
你都可以自己去决定，从第一天开始我就需要根据当前架构独立写一个东西出来，从整个项目的估期到全部所有的决定权都在作为owner的你手上。这种环境下的成长是非常可怕的。记得第一个月吧每天都是电脑回家写到一两点、
但是不会觉得什么因为能够真切感受到自己的水平在飞速的提升。小公司甚至后端工程师会帮你写几个data model，前端工程师会去commit几个接口。没有那一套代码权限有的就是每一个project的owner的存在。这种感觉我觉得是一个喜欢
写代码的人应该经历过一次的至少我觉得。当然还有朋友、在一个比家人在一起都多的朋友的圈里、才可以开心的做自己喜欢去做的事情。毕业季最伤感的或许也有一点是离开的火花吧。</li>
</ul>

<h4>软件组</h4>

<ul>
<li>从大一的在这里很不错、到大二的在这里是为了我可以自由做我想做的事情的地方、到大三这是一份责任、到现在有一丝愧疚。我觉得我还是一个失败的组长，摸着良心我努力尽力了、换言之我不是一个合格的育人者。但是我相信
我自己的眼光、现在这几个大二的同学我更会相信你们是会变的很厉害的！看着基友组网络更觉得愧疚Orz。<del>没人想看着中心差下去的或许是不是该有点从能培养出强大的模式里去借鉴什么呢？</del></li>
</ul>

<h4>班级</h4>

<ul>
<li>有时候感觉对我来说、寝室只是个睡觉的地方。想想为什么造成的或许也应该主要是自己的原因。其实想想也挺对不起自己寝室的人的、大一的时候带他们去网吧去玩游戏、却从没考虑他们是否是能够自己收的了的问题。
慢慢的一种恶性循环开始。我也要挺感谢dp的至少能够包容我。</li>
<li>从来我就不是个好人也多谢班级各种帮我擦屁股的同学，也是能够让我混到各种学分的关键。很多人、也许大概我不说话、但心里会说句谢谢！</li>
</ul>

    </div>

  
    <ul class="tag_box inline">
      <li><i class="icon-folder-open"></i></li>
      
      


  
    
    	<li><a href="#gossip-ref">
    		gossip <span>5</span>
    	</a></li>
    
  



    </ul>
  

  
    <ul class="tag_box inline">
      <li><i class="icon-tags"></i></li>
      
      


  
    
    	<li><a href="#dut-ref">dut <span>1</span></a></li>
    
    	<li><a href="#cippus-ref">cippus <span>1</span></a></li>
    
  



    </ul>
  
  </div>
</div>


<div class="page-header">
  <h3><a href="/program/2014/06/05/begin-with-swift">Begin With Swift </a></h3>
  <div class="date">
    <span>05 June 2014</span>
  </div>
</div>

<div class="row-fluid post-full">
  <div class="span12">
    <div class="content">
      <h3>OC Swift混编</h3>

<ul>
<li><a href="https://developer.apple.com/library/prerelease/ios/documentation/Swift/Conceptual/BuildingCocoaApps/index.html">大家好我是传送门= =</a></li>
<li><p>其实官方文档里写的各种东西也非常清楚的、我就用简单的描述下</p></li>
<li><p>swift</p>

<ul>
<li>如果需要引入同样的swift代码、只需要直接用就可以了！！！ (总之我也不知道工程索引文件什么的ide悄悄藏在什么地方了……</li>
<li>如果需要引入oc代码、首先需要生成一个<code>ProductName-Bridging-Header.h</code>的头文件(倒入随便一个oc文件就自动生成了)
然后只需要把所有需要用到的oc头文件在这个header import进去，你的swift代码就可以随意这些类了！！(黑科技就是auto complete的时候怎么把oc的头文件自动转成swift的头文件的！！完全不知道ide偷偷的去哪儿生成了这些中间代码Orz……</li>
</ul></li>
<li><p>objective-c</p>

<ul>
<li>如果需要引入oc代码= =原来怎么搞现在怎么搞= =怎么说都感觉是废话= =

<ul>
<li>如果需要引入swift代码、首先在setting中打开<code>Defines Module</code>为YES、然后在需要使用的那个oc的 .m文件中引入 <code>#import &quot;ProductModuleName-Swift.h&quot;</code> 文档里的用<code>&lt;&gt;</code>引的应该是别的framework的依次类推、其中ProductModuleName可以在setting中设置
<strong>这个文件不需要自己新建</strong>ide在一个很奇怪的角落里建好了……</li>
</ul></li>
</ul></li>
<li><p>混编完全无痛吧<em>(:з”∠)</em></p></li>
</ul>

<h3>swift 语法特点 (粗略)</h3>

<ul>
<li><a href="https://itunes.apple.com/book/swift-programming-language/id881256329?mt=11&amp;ign-mpt=uo%3D4">The Swift Programming Language (以下略为书)</a></li>
<li><p>类型推断、参数约束描述等等 见如下</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">func anyCommonElements &lt;T, U where T: Sequence, U: Sequence, T.GeneratorType.Element: Equatable, T.GeneratorType.Element == U.GeneratorType.Element&gt; (lhs: T, rhs: U) -&gt; Bool {
  for lhsItem in lhs {
      for rhsItem in rhs {
          if lhsItem == rhsItem {
              return true
          }
      }
  }
  return false
}
anyCommonElements([1, 2, 3], [3])
</code></pre></div></li>
<li><p>optional</p>

<ul>
<li>在swift加入了两个语法糖一样性质的! 和 ? 分别是拆包 装包</li>
<li>可以用在一些判空的地方例如
<code>
//任意一个为空就中止不会走下去了、类似oc中的对nil perferselector不会crash一样
john.residence?.address?.buildingIdentifier() {}
</code></li>
<li>包的感觉类似这样的感觉 例如函数中定义的是String 而你的 var a: String? 传入String要保证非空就必须一次解包操作如果这个时候值为空就crash</li>
</ul>
<div class="highlight"><pre><code class="language-text" data-lang="text">  enum Optional&lt;T&gt; {
    Some(T)
    None
  }
</code></pre></div></li>
<li><p>闭包、oc的block折腾够了么……好吧这回终于有简单明了爽快的闭包了Orz</p>

<ul>
<li>一般定义</li>
</ul>
<div class="highlight"><pre><code class="language-text" data-lang="text">  {
    (arg1: Type, arg2: Type) -&gt; returnType in
    closure content
  }
</code></pre></div>
<ul>
<li>sort Array</li>
</ul>
<div class="highlight"><pre><code class="language-text" data-lang="text">  var l: Array = [3, 4, 6, 1, 2]
  sort(l, {
    (i1: Int, i2: Int) -&gt; Bool in
    return i1 &gt; i2
    })
  //嫌烦里面的type可以被推断出来所以可以省略
  sort(l, {i1, i2 in return i1 &gt; i2})
  //还可以更短= =
  sort(l, { $0 &gt; $1})
  //还他妈可以更短！= =
  sort(l, &gt;)
</code></pre></div>
<ul>
<li>注意一些循环引用的这些东西</li>
<li>unowned 弱引用非空对象(不init 编译器还报错</li>
<li>weak 弱引用可空的wrap过的对象就是那些加?的</li>
<li>详情可见书245页</li>
</ul></li>
<li><p>setter getter willSet didSet</p>

<ul>
<li>类似c#的大大简化工作量……java那种seter getter去死吧混蛋！</li>
</ul></li>
<li><p>碉堡的switch case……妈妈再也不用担心我一排if了= = 见书179页</p></li>
<li><p>还有各种符号重载、特别是<code>[]</code>也是非常的方便！(不过有一大堆关键字Orz 见书619页</p></li>
<li><p>更多</p>

<ul>
<li>还有各种各样的特性从脚本语言过来的话应该都是非常熟悉的比如返回个<code>tuple</code>什么的啦字典<code>keyvalue遍历</code>啦<code>for _ in 1..5</code>这种写法啦、oc的一些类似category那样的写法同样也由extension保留了下来</li>
<li>一言以蔽之、swift的语法特性简直就是叼炸天、完全不觉得这个是Apple出的toy language、嗯就是这样啦！</li>
<li>redcarpet快支持swift吧……没语法高亮好不爽！</li>
</ul></li>
</ul>

<h3>感想</h3>

<ul>
<li>2014wwdc苹果新发表的语言嘛、不知道为什么就是特别的热= =难道跟名字有关么(听说swift贴吧都被占领了23333</li>
<li>实际体验了下完全不知道苹果用什么黑科技bridge oc 和 swift的，除了代码提示几乎没有之外几乎两个语言完全自然连接的</li>
<li>粗粗把<a href="https://itunes.apple.com/book/swift-programming-language/id881256329?mt=11&amp;ign-mpt=uo%3D4">The Swift Programming Language</a>、有种特别熟悉的感觉……互联网上讨论也特别多、有厨有黑、包括各种媒体什么的也插一脚很多人都说像python，我倒是不怎么觉得，倒是各种语言的影子都可以看到一些而且东西特别多……不过脑补都知道完全用起来的话肯定很爽</li>
<li>xcode6的bug特别多……

<ul>
<li>background 他是边写代码就一边在跑的所以比如 <code>system(rm -rf ~/)</code>这种命令&gt; &lt;</li>
<li>群里看到的一句话干崩xcode…… <code>var b = 1; println(&quot;a&quot;, b)</code></li>
<li>小tips</li>
<li>开始纯粹练语法的话比较那个background比较核心……还不如用cli模式进去打了试东西目录在</Applications/Xcode6-Beta.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/>
可以 <code>PATH=$PATH:/Applications/Xcode6-Beta.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/</code> 然后命令行swift进cli试验(这样就算挂了也不会xcode无限重启&gt; &lt;</li>
</ul></li>
</ul>

<hr>

    </div>

  
    <ul class="tag_box inline">
      <li><i class="icon-folder-open"></i></li>
      
      


  
    
    	<li><a href="#program-ref">
    		program <span>43</span>
    	</a></li>
    
  



    </ul>
  

  
    <ul class="tag_box inline">
      <li><i class="icon-tags"></i></li>
      
      


  
    
    	<li><a href="#swift-ref">swift <span>1</span></a></li>
    
    	<li><a href="#objective-c-ref">objective-c <span>1</span></a></li>
    
  



    </ul>
  
  </div>
</div>


<div class="page-header">
  <h3><a href="/gossip/2014/05/30/clearance">毕业贩卖 </a></h3>
  <div class="date">
    <span>30 May 2014</span>
  </div>
</div>

<div class="row-fluid post-full">
  <div class="span12">
    <div class="content">
      <h3>毕业甩卖</h3>

<h4>EggPlus</h4>

<ul>
<li><strong>出售：60</strong></li>
<li>附赠金龙鱼大豆油 900ml一瓶</li>
<li>附赠清洗工具</li>
<li>渠道 <a href="http://www.mygeek.cn/product/Pro1721.Html">http://www.mygeek.cn/product/Pro1721.Html</a></li>
<li>原价 120</li>
<li><img src="/assets/static/2014-05-30-2.jpg" alt="eggplus"></li>
</ul>

<h4>电风扇</h4>

<ul>
<li><strong>出售：25</strong>
<img src="/assets/static/2014-05-30-3.jpg" alt="fan"></li>
</ul>

<h4>显示器</h4>

<ul>
<li><strong><del>出售：已售</del></strong></li>
<li>19寸</li>
<li>分辨率 1440*900</li>
<li>渠道 <a href="http://item.jd.com/172532.html">http://item.jd.com/172532.html</a></li>
<li>原价 699</li>
<li>图为高度和13寸本的对比</li>
<li><img src="/assets/static/2014-05-30-1.jpg" alt="13寸笔记本的对比">
*
<strong>ps. 造福学弟，最好支付宝交易</strong>
<a href="mailto:zhangxzheng@gmail.com">Email</a></li>
</ul>

    </div>

  
    <ul class="tag_box inline">
      <li><i class="icon-folder-open"></i></li>
      
      


  
    
    	<li><a href="#gossip-ref">
    		gossip <span>5</span>
    	</a></li>
    
  



    </ul>
  

  
    <ul class="tag_box inline">
      <li><i class="icon-tags"></i></li>
      
      


  
    
  



    </ul>
  
  </div>
</div>


<div class="page-header">
  <h3><a href="/program/2014/05/27/migrate-blog-from-wp-to-gp">wordpress迁移github page </a></h3>
  <div class="date">
    <span>27 May 2014</span>
  </div>
</div>

<div class="row-fluid post-full">
  <div class="span12">
    <div class="content">
      <h3>工作</h3>

<ol>
<li>host在github上</li>
<li>安装jekyll bootstrap <del>简称jb</del></li>
<li>导出wordpress评论以及内容</li>
<li>处理wordpress的内容转化为markdown</li>
<li>注意事项</li>
</ol>

<h4>host在github上</h4>

<ol>
<li><a href="https://pages.github.com/">https://pages.github.com/</a></li>
<li>新建一个username.github.io的repo</li>
<li><a href="https://help.github.com/articles/setting-up-a-custom-domain-with-github-pages">绑定域名</a></li>
</ol>

<h4>安装 jb</h4>

<ol>
<li><a href="http://jekyllbootstrap.com/">http://jekyllbootstrap.com/</a></li>
<li>安装jekyll</li>
<li>clone代码 并看一下sample的样例以及api</li>
</ol>

<hr>

<h4>导出wordpress评论以及内容</h4>

<ul>
<li>导出评论

<ul>
<li>由于github page采用的是纯静态的、评论这种那么麻烦的东西索性还是交给第三方好啦= =在github上我使用的是<a href="http://disqus.com/">disqus</a>，他也同时提供从wordpress导出的功能</li>
<li>创建 disqus账号 <disqus.com/admin/create></li>
<li>添加自己的site并安装wp插件 <a href="http://wordpress.org/plugins/disqus-comment-system/">http://wordpress.org/plugins/disqus-comment-system/</a></li>
<li>等待disques后台进程帮你抓完会通知你的</li>
</ul></li>
<li>导出内容

<ul>
<li>导出content 使用wordpress的导出工具导出xml即可</li>
</ul></li>
</ul>

<h4>转换内容</h4>

<ul>
<li>导出mark down

<ul>
<li><del>jekyll 有一个jekyll-import 的工具、不过中文支持的巨差无比</del></li>
<li>使用一个改进过对中文支持的版本 <a href="https://gist.github.com/chitsaou/1394128">https://gist.github.com/chitsaou/1394128</a></li>
<li>导出的xml命名 (wordpress.xml) 如下命令会把为你生成一拖post 以及wordpress中的page
<code>ruby
ruby -r &quot;./wordpressdotcom.rb&quot; -e &quot;Jekyll::WordpressDotCom.process&quot;
</code></li>
<li>如果在wordpress中没有使用什么插件类似<strong>codebox</strong>这样的到这一步就导入成功了</li>
<li>如果使用了一些奇怪的语法在html用插件解出来的格式就一塌糊涂了，比如我的所有的代码都是用codebox的……
写了一段简单的脚本来处理html，基本思路都是文本解析到codebox的开始标签pre然后替换掉</li>
</ul></li>
</ul>
<div class="highlight"><pre><code class="language-python" data-lang="python">    <span class="n">__author__</span> <span class="o">=</span> <span class="s">&#39;zhangxinzheng&#39;</span>
    <span class="c"># -*- coding: utf-8 -*-</span>
    <span class="kn">import</span> <span class="nn">sys</span>
    <span class="kn">import</span> <span class="nn">re</span>
    <span class="kn">import</span> <span class="nn">os</span>
    <span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">filename</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&quot;html&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">targetName</span> <span class="o">=</span> <span class="n">filename</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;html&quot;</span><span class="p">,</span><span class="s">&quot;md&quot;</span><span class="p">)</span>
        <span class="n">fd</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s">&quot;r+&quot;</span><span class="p">)</span>
        <span class="nb">str</span> <span class="o">=</span> <span class="s">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fd</span><span class="o">.</span><span class="n">readlines</span><span class="p">())</span>
        <span class="k">while</span> <span class="nb">str</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&quot;&lt;pre&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">tempString</span><span class="o">=</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">```</span><span class="se">\n</span><span class="s">&quot;</span>
            <span class="n">isContent</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="n">startIndex</span> <span class="o">=</span> <span class="nb">str</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&quot;&lt;pre&quot;</span><span class="p">)</span>
            <span class="n">endIndex</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
            <span class="n">realEnd</span> <span class="o">=</span> <span class="n">startIndex</span>
            <span class="n">leftCount</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">rightCount</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="n">startIndex</span><span class="p">,</span> <span class="n">endIndex</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">str</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;&lt;&#39;</span><span class="p">:</span>
                    <span class="n">isContent</span> <span class="o">=</span> <span class="bp">False</span>
                    <span class="n">leftCount</span> <span class="o">+=</span><span class="mi">1</span>
                <span class="k">if</span> <span class="n">isContent</span><span class="p">:</span>
                    <span class="n">tempString</span><span class="o">+=</span><span class="nb">str</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                <span class="k">if</span> <span class="nb">str</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="s">&#39;&gt;&#39;</span><span class="p">:</span>
                    <span class="n">isContent</span> <span class="o">=</span> <span class="bp">True</span>
                    <span class="n">rightCount</span> <span class="o">+=</span><span class="mi">1</span>
                    <span class="n">realEnd</span> <span class="o">=</span> <span class="n">j</span>
                <span class="k">if</span> <span class="n">leftCount</span> <span class="o">==</span> <span class="n">rightCount</span><span class="p">:</span>
                    <span class="k">break</span>
            <span class="nb">str</span><span class="o">+=</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">```</span><span class="se">\n</span><span class="s">&quot;</span>
            <span class="nb">str</span><span class="o">=</span><span class="nb">str</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="nb">str</span><span class="p">[</span><span class="n">startIndex</span><span class="p">:</span><span class="n">realEnd</span><span class="p">],</span> <span class="n">tempString</span><span class="p">)</span>
        <span class="n">fd</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="n">fd</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">targetName</span><span class="p">,</span> <span class="s">&quot;w+&quot;</span><span class="p">)</span>
        <span class="n">fd</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
        <span class="n">fd</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&quot;__main__&quot;</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">:</span>
            <span class="n">f</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</code></pre></div>
<h4>注意事项</h4>

<ol>
<li>中文路径在github上跑起来没问题，但是本地调试时会报错</li>
</ol>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby">    <span class="sx">% LANG=&quot;en_US.UTF-8&quot; </span><span class="no">LC_ALL</span><span class="o">=</span><span class="s2">&quot;en_US.UTF-8&quot;</span> <span class="n">be</span> <span class="n">jekyll</span> <span class="n">build</span> <span class="o">--</span><span class="n">trace</span>
    <span class="no">Configuration</span> <span class="ss">file</span><span class="p">:</span> <span class="sr">/Users/</span><span class="n">albertogg</span><span class="o">/</span><span class="no">Documents</span><span class="o">/</span><span class="n">beyondalbert</span><span class="o">.</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">_config</span><span class="o">.</span><span class="n">yml</span>
                <span class="ss">Source</span><span class="p">:</span> <span class="sr">/Users/</span><span class="n">albertogg</span><span class="o">/</span><span class="no">Documents</span><span class="o">/</span><span class="n">beyondalbert</span><span class="o">.</span><span class="n">github</span><span class="o">.</span><span class="n">com</span>
           <span class="ss">Destination</span><span class="p">:</span> <span class="sr">/Users/</span><span class="n">albertogg</span><span class="o">/</span><span class="no">Documents</span><span class="o">/</span><span class="n">beyondalbert</span><span class="o">.</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">_site</span>
          <span class="no">Generating</span><span class="o">.</span><span class="n">.</span><span class="o">.</span>
    <span class="sr">/Users/</span><span class="n">albertogg</span><span class="o">/</span><span class="no">Documents</span><span class="o">/</span><span class="no">Github</span><span class="o">/</span><span class="n">jekyll</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">jekyll</span><span class="o">.</span><span class="n">rb</span><span class="p">:</span><span class="mi">121</span><span class="ss">:in</span> <span class="sb">`gsub!&#39;: invalid byte sequence in US-ASCII (ArgumentError)</span>
<span class="sb">        from /Users/albertogg/Documents/Github/jekyll/lib/jekyll.rb:121:in `</span><span class="n">sanitized_path</span><span class="s1">&#39;</span>
<span class="s1">        from /Users/albertogg/Documents/Github/jekyll/lib/jekyll/post.rb:276:in `destination&#39;</span>
        <span class="n">from</span> <span class="sr">/Users/</span><span class="n">albertogg</span><span class="o">/</span><span class="no">Documents</span><span class="o">/</span><span class="no">Github</span><span class="o">/</span><span class="n">jekyll</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">jekyll</span><span class="o">/</span><span class="n">cleaner</span><span class="o">.</span><span class="n">rb</span><span class="p">:</span><span class="mi">43</span><span class="ss">:in</span> <span class="sb">`block in new_files&#39;</span>
<span class="sb">        from /Users/albertogg/Documents/Github/jekyll/lib/jekyll/site.rb:420:in `</span><span class="n">block</span> <span class="p">(</span><span class="mi">2</span> <span class="n">levels</span><span class="p">)</span> <span class="k">in</span> <span class="n">each_site_file</span><span class="s1">&#39;</span>
<span class="s1">        from /Users/albertogg/Documents/Github/jekyll/lib/jekyll/site.rb:419:in `each&#39;</span>
        <span class="n">from</span> <span class="sr">/Users/</span><span class="n">albertogg</span><span class="o">/</span><span class="no">Documents</span><span class="o">/</span><span class="no">Github</span><span class="o">/</span><span class="n">jekyll</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">jekyll</span><span class="o">/</span><span class="n">site</span><span class="o">.</span><span class="n">rb</span><span class="p">:</span><span class="mi">419</span><span class="ss">:in</span> <span class="sb">`block in each_site_file&#39;</span>
<span class="sb">        from /Users/albertogg/Documents/Github/jekyll/lib/jekyll/site.rb:418:in `</span><span class="n">each</span><span class="s1">&#39;</span>
<span class="s1">        from /Users/albertogg/Documents/Github/jekyll/lib/jekyll/site.rb:418:in `each_site_file&#39;</span>
        <span class="n">from</span> <span class="sr">/Users/</span><span class="n">albertogg</span><span class="o">/</span><span class="no">Documents</span><span class="o">/</span><span class="no">Github</span><span class="o">/</span><span class="n">jekyll</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">jekyll</span><span class="o">/</span><span class="n">cleaner</span><span class="o">.</span><span class="n">rb</span><span class="p">:</span><span class="mi">43</span><span class="ss">:in</span> <span class="sb">`new_files&#39;</span>
<span class="sb">        from /Users/albertogg/Documents/Github/jekyll/lib/jekyll/cleaner.rb:24:in `</span><span class="n">obsolete_files</span><span class="s1">&#39;</span>
<span class="s1">        from /Users/albertogg/Documents/Github/jekyll/lib/jekyll/cleaner.rb:15:in `cleanup!&#39;</span>
        <span class="n">from</span> <span class="sr">/Users/</span><span class="n">albertogg</span><span class="o">/</span><span class="no">Documents</span><span class="o">/</span><span class="no">Github</span><span class="o">/</span><span class="n">jekyll</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">jekyll</span><span class="o">/</span><span class="n">site</span><span class="o">.</span><span class="n">rb</span><span class="p">:</span><span class="mi">255</span><span class="ss">:in</span> <span class="sb">`cleanup&#39;</span>
<span class="sb">        from /Users/albertogg/Documents/Github/jekyll/lib/jekyll/site.rb:44:in `</span><span class="n">process</span><span class="s1">&#39;</span>
<span class="s1">        from /Users/albertogg/Documents/Github/jekyll/lib/jekyll/command.rb:43:in `process_site&#39;</span>
        <span class="n">from</span> <span class="sr">/Users/</span><span class="n">albertogg</span><span class="o">/</span><span class="no">Documents</span><span class="o">/</span><span class="no">Github</span><span class="o">/</span><span class="n">jekyll</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">jekyll</span><span class="o">/</span><span class="n">commands</span><span class="o">/</span><span class="n">build</span><span class="o">.</span><span class="n">rb</span><span class="p">:</span><span class="mi">46</span><span class="ss">:in</span> <span class="sb">`build&#39;</span>
<span class="sb">        from /Users/albertogg/Documents/Github/jekyll/lib/jekyll/commands/build.rb:30:in `</span><span class="n">process</span><span class="s1">&#39;</span>
<span class="s1">        from /Users/albertogg/Documents/Github/jekyll/lib/jekyll/commands/build.rb:17:in `block (2 levels) in init_with_program&#39;</span>
        <span class="n">from</span> <span class="sr">/Users/</span><span class="n">albertogg</span><span class="o">/.</span><span class="n">rbenv</span><span class="o">/</span><span class="n">versions</span><span class="o">/</span><span class="mi">2</span><span class="o">.</span><span class="mi">1</span><span class="o">.</span><span class="mi">2</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">ruby</span><span class="o">/</span><span class="n">gems</span><span class="o">/</span><span class="mi">2</span><span class="o">.</span><span class="mi">1</span><span class="o">.</span><span class="mi">0</span><span class="o">/</span><span class="n">gems</span><span class="o">/</span><span class="n">mercenary</span><span class="o">-</span><span class="mi">0</span><span class="o">.</span><span class="mi">3</span><span class="o">.</span><span class="mi">3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">mercenary</span><span class="o">/</span><span class="n">command</span><span class="o">.</span><span class="n">rb</span><span class="p">:</span><span class="mi">220</span><span class="ss">:in</span> <span class="sb">`call&#39;</span>
<span class="sb">        from /Users/albertogg/.rbenv/versions/2.1.2/lib/ruby/gems/2.1.0/gems/mercenary-0.3.3/lib/mercenary/command.rb:220:in `</span><span class="n">block</span> <span class="k">in</span> <span class="n">execute</span><span class="s1">&#39;</span>
<span class="s1">        from /Users/albertogg/.rbenv/versions/2.1.2/lib/ruby/gems/2.1.0/gems/mercenary-0.3.3/lib/mercenary/command.rb:220:in `each&#39;</span>
        <span class="n">from</span> <span class="sr">/Users/</span><span class="n">albertogg</span><span class="o">/.</span><span class="n">rbenv</span><span class="o">/</span><span class="n">versions</span><span class="o">/</span><span class="mi">2</span><span class="o">.</span><span class="mi">1</span><span class="o">.</span><span class="mi">2</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">ruby</span><span class="o">/</span><span class="n">gems</span><span class="o">/</span><span class="mi">2</span><span class="o">.</span><span class="mi">1</span><span class="o">.</span><span class="mi">0</span><span class="o">/</span><span class="n">gems</span><span class="o">/</span><span class="n">mercenary</span><span class="o">-</span><span class="mi">0</span><span class="o">.</span><span class="mi">3</span><span class="o">.</span><span class="mi">3</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">mercenary</span><span class="o">/</span><span class="n">command</span><span class="o">.</span><span class="n">rb</span><span class="p">:</span><span class="mi">220</span><span class="ss">:in</span> <span class="sb">`execute&#39;</span>
<span class="sb">        from /Users/albertogg/.rbenv/versions/2.1.2/lib/ruby/gems/2.1.0/gems/mercenary-0.3.3/lib/mercenary/program.rb:35:in `</span><span class="n">go</span><span class="s1">&#39;</span>
<span class="s1">        from /Users/albertogg/.rbenv/versions/2.1.2/lib/ruby/gems/2.1.0/gems/mercenary-0.3.3/lib/mercenary.rb:22:in `program&#39;</span>
        <span class="n">from</span> <span class="sr">/Users/</span><span class="n">albertogg</span><span class="o">/</span><span class="no">Documents</span><span class="o">/</span><span class="no">Github</span><span class="o">/</span><span class="n">jekyll</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="ss">jekyll</span><span class="p">:</span><span class="mi">18</span><span class="ss">:in</span> <span class="sb">`&lt;top (required)&gt;&#39;</span>
<span class="sb">        from /Users/albertogg/.rbenv/versions/2.1.2/lib/ruby/gems/2.1.0/bin/jekyll:23:in `</span><span class="nb">load</span><span class="s1">&#39;</span>
<span class="s1">        from /Users/albertogg/.rbenv/versions/2.1.2/lib/ruby/gems/2.1.0/bin/jekyll:23:in `&lt;main&gt;&#39;</span>
    <span class="sb">```</span>
<span class="sb">  * 详见这个&lt;https://github.com/jekyll/jekyll/issues/2379&gt; 修改了报错那行为</span>
<span class="sb">  ```</span><span class="n">ruby</span>
    <span class="n">clean_path</span><span class="o">.</span><span class="n">force_encoding</span><span class="p">(</span><span class="s1">&#39;UTF-8&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">gsub!</span><span class="p">(</span><span class="sr">/\A\w\:\//</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">)</span>
</code></pre></div>
<ol>
<li>使用里面的代码高亮很不爽可以参见gfm使用他的语法并在config中调整配置
<code>
markdown: redcarpet
redcarpet:
  extensions: [&quot;no_intra_emphasis&quot;, &quot;fenced_code_blocks&quot;, &quot;autolink&quot;, &quot;strikethrough&quot;, &quot;superscript&quot;]
</code></li>
<li>代码高亮开启了pygments后的css也需要自己配置来写

<ul>
<li>可以参加<a href="https://github.com/richleland/pygments-css">https://github.com/richleland/pygments-css</a></li>
</ul></li>
</ol>

    </div>

  
    <ul class="tag_box inline">
      <li><i class="icon-folder-open"></i></li>
      
      


  
    
    	<li><a href="#program-ref">
    		program <span>43</span>
    	</a></li>
    
  



    </ul>
  

  
    <ul class="tag_box inline">
      <li><i class="icon-tags"></i></li>
      
      


  
    
    	<li><a href="#wordpress-ref">wordpress <span>1</span></a></li>
    
    	<li><a href="#github-ref">github <span>1</span></a></li>
    
  



    </ul>
  
  </div>
</div>


<div class="page-header">
  <h3><a href="/program/2014/03/06/tableview%E4%B8%8A%E6%BB%91%E5%8A%A8%E6%97%B6%E7%9A%84navigation%20bar%E7%9A%84%E9%81%AE%E7%BD%A9">tableview上滑动时的navigation bar的遮罩 </a></h3>
  <div class="date">
    <span>06 March 2014</span>
  </div>
</div>

<div class="row-fluid post-full">
  <div class="span12">
    <div class="content">
      <p>这个需求本来并不复杂、烦人的几乎这端遮罩代码要复用到每个tablview所在的场景、非常的不合适、直到看到了前辈写的一段hack到暴的代码才深知道所在的差距……
他大致的思路就是给scrollview拓展了一个category、利用ios的运行时的特性、在他load的时候直接把他的setContenOffset给替换掉成了自己的函数、用他来控制公共的navigationbar
代码如下</p>
<div class="highlight"><pre><code class="language-objective-c" data-lang="objective-c"><span class="k">@interface</span> <span class="nc">UIScrollView</span> <span class="nl">(ContentOffset)</span>

<span class="k">+</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">load</span><span class="p">;</span> <span class="c1">//复写掉load方法</span>

<span class="k">@end</span>

<span class="k">@implementation</span> <span class="nc">UIScrollView</span> <span class="nl">(ContentOffset)</span>

<span class="k">+</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">load</span>
<span class="p">{</span>
    <span class="n">method_exchangeImplementations</span><span class="p">(</span><span class="n">class_getInstanceMethod</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="k">@selector</span><span class="p">(</span><span class="n">setContentOffset</span><span class="o">:</span><span class="p">)),</span> <span class="n">class_getInstanceMethod</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="k">@selector</span><span class="p">(</span><span class="n">swizzled_setContentOffset</span><span class="o">:</span><span class="p">)));</span><span class="c1">//替换原生的与自己重写的</span>
<span class="p">}</span>

<span class="k">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">swizzled_setContentOffset:</span><span class="p">(</span><span class="n">CGPoint</span><span class="p">)</span><span class="nv">point</span>
<span class="p">{</span>
    <span class="p">[</span><span class="n">self</span> <span class="n">swizzled_setContentOffset</span><span class="o">:</span><span class="n">point</span><span class="p">];</span><span class="c1">//由于此时已经被交换了所以调用自己相当于是在调原生的setContOffset</span>

    <span class="n">ZDDeckViewManager</span> <span class="o">*</span><span class="n">deck</span> <span class="o">=</span> <span class="p">[</span><span class="n">ZDDeckViewManager</span> <span class="n">sharedInstance_ks</span><span class="p">];</span><span class="c1">//单例拿到大家一起控制的navigationbar</span>
    <span class="cm">/*这里就可以在滑动状态上对bar做任何事情了*/</span>
<span class="p">}</span>

<span class="k">@end</span>
</code></pre></div>
    </div>

  
    <ul class="tag_box inline">
      <li><i class="icon-folder-open"></i></li>
      
      


  
    
    	<li><a href="#program-ref">
    		program <span>43</span>
    	</a></li>
    
  



    </ul>
  

  
    <ul class="tag_box inline">
      <li><i class="icon-tags"></i></li>
      
      


  
    
  



    </ul>
  
  </div>
</div>


<div class="page-header">
  <h3><a href="/program/2014/03/05/%E6%9C%AA%E5%BC%95%E7%94%A8%E5%9B%BE%E7%89%87%E5%88%A0%E9%99%A4">未引用图片删除 </a></h3>
  <div class="date">
    <span>05 March 2014</span>
  </div>
</div>

<div class="row-fluid post-full">
  <div class="span12">
    <div class="content">
      <p>同理可以用来处理些别的资源文件</p>
<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="c">#!/bin/sh</span>
<span class="nv">PROJ</span><span class="o">=</span><span class="sb">`</span>find . -name <span class="s1">&#39;*.xib&#39;</span> -o -name <span class="s1">&#39;*.[mh]&#39;</span><span class="sb">`</span>

<span class="k">for </span>png in <span class="sb">`</span>find . -name <span class="s1">&#39;*.png&#39;</span> <span class="p">|</span> grep -v @2x<span class="sb">`</span> <span class="c">#所要处理的资源文件类型</span>
<span class="k">do</span>
<span class="k">    </span><span class="nv">name</span><span class="o">=</span><span class="sb">`</span>basename <span class="nv">$png</span><span class="sb">`</span>
    <span class="nv">name</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="nv">$name</span> <span class="p">|</span> sed -e <span class="s1">&#39;s/\.png//g&#39;</span><span class="sb">`</span>  <span class="c">#在代码中的表现形势、如果有一些拼串的需要特殊处理</span>
    <span class="k">if</span> ! grep -qhs <span class="nv">$name</span> <span class="nv">$PROJ</span><span class="p">;</span> <span class="k">then</span>
<span class="k">        </span><span class="nv">tmp</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="nv">$png</span> <span class="p">|</span> grep /Zhidao/Resources/Image <span class="p">|</span> grep -v /Image/Professional/<span class="sb">`</span> <span class="c">#排除一些不想处理的文件架比如引用外部封完的东西的</span>
        <span class="k">if</span> <span class="o">[</span> <span class="s2">&quot;$tmp&quot;</span> <span class="o">=</span> <span class="s2">&quot;$png&quot;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
<span class="k">            </span><span class="nb">echo</span> <span class="s2">&quot;$png is not referenced&quot;</span>
<span class="c">#           svn rm $png</span>
<span class="c">#           doubleName=`echo $png | sed -e &#39;s/\.png/@2x\.png/g&#39;`</span>
<span class="c">#           svn rm $doubleName@</span>

        <span class="k">fi</span>
<span class="k">    fi</span>
<span class="k">done</span>
</code></pre></div>
    </div>

  
    <ul class="tag_box inline">
      <li><i class="icon-folder-open"></i></li>
      
      


  
    
    	<li><a href="#program-ref">
    		program <span>43</span>
    	</a></li>
    
  



    </ul>
  

  
    <ul class="tag_box inline">
      <li><i class="icon-tags"></i></li>
      
      


  
    
  



    </ul>
  
  </div>
</div>


<div class="page-header">
  <h3><a href="/program/2014/02/03/%E5%85%B3%E4%BA%8Ensurlsessiondownloadtask%E7%9A%84%E5%8F%82%E6%95%B0%E4%BC%A0%E9%80%92">关于NSURLSessionDownloadTask的参数传递 </a></h3>
  <div class="date">
    <span>03 February 2014</span>
  </div>
</div>

<div class="row-fluid post-full">
  <div class="span12">
    <div class="content">
      <p>ios7开放了一组新的api其中一个最吸引人的也应该就是开放了后台下载的接口。当然凭ios一贯的作风肯定是把接口封的简单的要死然后用着噁心的要死……反正我是绝对被噁心到了、最近要解决的一个问题就是把downloadtask和实体关联上的问题。当然最简单的就是传参数了，然后我可以很负责的告诉你……尼玛你assign task的时候和从call back拿的时候不是一个实体！！！wtf……所以什么用runtime给他加点奇怪的东西什么都别想了……<br />
-------------------------------------------万恶的分割线-----------------------------------------------<br />
然后就说下解决办法吧……其实想想是会吐血的，仔细看看他的.h里面终于发现了还有这个一个东西……至少他是不会变的……<br />
所以我们既然找到了有不变的东西那么就终于可以有解决办法了……直接把要传的东西转成json靠这个东西传简直轻松又愉快……</p>
<div class="highlight"><pre><code class="language-objective-c" data-lang="objective-c"><span class="cm">/*</span>
<span class="cm"> * The taskDescription property is available for the developer to</span>
<span class="cm"> * provide a descriptive label for the task.</span>
<span class="cm"> */</span>
<span class="k">@property</span> <span class="p">(</span><span class="n">copy</span><span class="p">)</span> <span class="n">NSString</span> <span class="o">*</span><span class="n">taskDescription</span><span class="p">;</span>
</code></pre></div>
    </div>

  
    <ul class="tag_box inline">
      <li><i class="icon-folder-open"></i></li>
      
      


  
    
    	<li><a href="#program-ref">
    		program <span>43</span>
    	</a></li>
    
  



    </ul>
  

  
    <ul class="tag_box inline">
      <li><i class="icon-tags"></i></li>
      
      


  
    
  



    </ul>
  
  </div>
</div>


<div class="page-header">
  <h3><a href="/program/2013/07/30/%E5%9C%86%E5%BD%A2%E5%B8%83%E5%B1%80%E7%9A%84icon%E9%A1%B5%E9%9D%A2-loading%E5%8A%A8%E7%94%BB%E6%95%88%E6%9E%9C">圆形布局的icon页面 loading动画效果 </a></h3>
  <div class="date">
    <span>30 July 2013</span>
  </div>
</div>

<div class="row-fluid post-full">
  <div class="span12">
    <div class="content">
      <p><a href="http://snorlax-wordpress.stor.sinaapp.com/uploads/2013/07/700BAD52-7C3F-4500-8B52-69C13291528D.jpg"><img src="http://snorlax-wordpress.stor.sinaapp.com/uploads/2013/07/700BAD52-7C3F-4500-8B52-69C13291528D.jpg" alt="" title="700BAD52-7C3F-4500-8B52-69C13291528D" width="314" height="470" class="alignnone size-full wp-image-397" /></a>
大致效果就是3个元素根据不同时间间隔开始沿着圆进行无限追逐，每次一圈后进行一个小停顿然后继续、比较类似wp7的那种小的loading、主要用到的还是CAKeyframeAnimation其中为了让无限循环中加上停顿用了个小trick
</p>
<div class="highlight"><pre><code class="language-objective-c" data-lang="objective-c"><span class="cp">#import &lt;QuartzCore/QuartzCore.h&gt;</span>
<span class="cp">#define PI 3.14159265358979323846</span>
<span class="k">@interface</span> <span class="nc">canvas</span> <span class="p">()</span>
<span class="p">{</span>
    <span class="n">UIButton</span> <span class="o">*</span><span class="n">red</span><span class="p">;</span>
    <span class="n">UIButton</span> <span class="o">*</span><span class="n">green</span><span class="p">;</span>
    <span class="n">UIButton</span> <span class="o">*</span><span class="n">yellow</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">@end</span>

<span class="k">@implementation</span> <span class="nc">canvas</span>

<span class="k">-</span> <span class="p">(</span><span class="kt">id</span><span class="p">)</span><span class="nf">initWithFrame:</span><span class="p">(</span><span class="n">CGRect</span><span class="p">)</span><span class="nv">frame</span>
<span class="p">{</span>
    <span class="n">self</span> <span class="o">=</span> <span class="p">[</span><span class="n">super</span> <span class="n">initWithFrame</span><span class="o">:</span><span class="n">frame</span><span class="p">];</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">self</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// Initialization code</span>
        <span class="n">red</span><span class="o">=</span><span class="p">[[</span><span class="n">UIButton</span> <span class="n">alloc</span><span class="p">]</span><span class="n">initWithFrame</span><span class="o">:</span><span class="n">CGRectMake</span><span class="p">(</span><span class="mf">117.55</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mf">38.1</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)];</span>
        <span class="n">green</span><span class="o">=</span><span class="p">[[</span><span class="n">UIButton</span> <span class="n">alloc</span><span class="p">]</span><span class="n">initWithFrame</span><span class="o">:</span><span class="n">CGRectMake</span><span class="p">(</span><span class="mf">141.42</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mf">58.57</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)];</span>
        <span class="n">yellow</span><span class="o">=</span><span class="p">[[</span><span class="n">UIButton</span> <span class="n">alloc</span><span class="p">]</span><span class="n">initWithFrame</span><span class="o">:</span><span class="n">CGRectMake</span><span class="p">(</span><span class="mf">173.2</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)];</span>
        <span class="p">[</span><span class="n">red</span> <span class="n">setBackgroundColor</span><span class="o">:</span><span class="p">[</span><span class="n">UIColor</span> <span class="n">redColor</span><span class="p">]];</span>
        <span class="p">[</span><span class="n">green</span> <span class="n">setBackgroundColor</span><span class="o">:</span><span class="p">[</span><span class="n">UIColor</span> <span class="n">greenColor</span><span class="p">]];</span>
        <span class="p">[</span><span class="n">yellow</span> <span class="n">setBackgroundColor</span><span class="o">:</span><span class="p">[</span><span class="n">UIColor</span> <span class="n">yellowColor</span><span class="p">]];</span>
        <span class="p">[</span><span class="n">red</span> <span class="n">addTarget</span><span class="o">:</span><span class="n">self</span> <span class="n">action</span><span class="o">:</span><span class="k">@selector</span><span class="p">(</span><span class="n">end</span><span class="p">)</span> <span class="n">forControlEvents</span><span class="o">:</span><span class="n">UIControlEventTouchUpInside</span><span class="p">];</span>
        <span class="p">[</span><span class="n">yellow</span> <span class="n">addTarget</span><span class="o">:</span><span class="n">self</span> <span class="n">action</span><span class="o">:</span><span class="k">@selector</span><span class="p">(</span><span class="n">start</span><span class="p">)</span> <span class="n">forControlEvents</span><span class="o">:</span><span class="n">UIControlEventTouchUpInside</span><span class="p">];</span>

        <span class="p">[</span><span class="n">self</span> <span class="n">start</span><span class="p">];</span>
        <span class="p">[</span><span class="n">self</span> <span class="n">addSubview</span><span class="o">:</span><span class="n">red</span><span class="p">];</span>
        <span class="p">[</span><span class="n">self</span> <span class="n">addSubview</span><span class="o">:</span><span class="n">green</span><span class="p">];</span>
        <span class="p">[</span><span class="n">self</span> <span class="n">addSubview</span><span class="o">:</span><span class="n">yellow</span><span class="p">];</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">self</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">-</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">end</span><span class="p">{</span>
    <span class="p">[</span><span class="n">red</span><span class="p">.</span><span class="n">layer</span> <span class="n">removeAllAnimations</span><span class="p">];</span>
    <span class="p">[</span><span class="n">green</span><span class="p">.</span><span class="n">layer</span> <span class="n">removeAllAnimations</span><span class="p">];</span>
    <span class="p">[</span><span class="n">yellow</span><span class="p">.</span><span class="n">layer</span> <span class="n">removeAllAnimations</span><span class="p">];</span>
<span class="p">}</span>
<span class="k">-</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">start</span><span class="p">{</span>
    <span class="n">CGMutablePathRef</span> <span class="n">path</span><span class="o">=</span><span class="n">CGPathCreateMutable</span><span class="p">();</span>
    <span class="n">CGPathAddArc</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="mf">0.0f</span><span class="p">,</span> <span class="mf">200.0f</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.8424</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.8424</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">PI</span><span class="p">,</span> <span class="nb">NO</span><span class="p">);</span><span class="c1">//用cgpath画出运动轨迹</span>
    <span class="n">CGPathAddArc</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="mf">0.0f</span><span class="p">,</span> <span class="mf">200.0f</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.8424</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.9424</span><span class="p">,</span> <span class="nb">YES</span><span class="p">);</span>
    <span class="n">CAKeyframeAnimation</span> <span class="o">*</span><span class="n">animation</span><span class="o">=</span><span class="p">[</span><span class="n">CAKeyframeAnimation</span> <span class="n">animationWithKeyPath</span><span class="o">:</span><span class="s">@&quot;position&quot;</span><span class="p">];</span>
    <span class="p">[</span><span class="n">animation</span> <span class="n">setCalculationMode</span><span class="o">:</span><span class="n">kCAAnimationPaced</span><span class="p">];</span>
    <span class="p">[</span><span class="n">animation</span> <span class="n">setPath</span><span class="o">:</span><span class="n">path</span><span class="p">];</span>
    <span class="p">[</span><span class="n">animation</span> <span class="n">setDuration</span><span class="o">:</span><span class="mf">2.0f</span><span class="p">];</span>
    <span class="p">[</span><span class="n">animation</span> <span class="n">setTimingFunction</span><span class="o">:</span><span class="p">[</span><span class="n">CAMediaTimingFunction</span> <span class="n">functionWithName</span><span class="o">:</span><span class="n">kCAMediaTimingFunctionEaseInEaseOut</span><span class="p">]];</span>
<span class="c1">//    [animation setBeginTime:CACurrentMediaTime()+0.7];</span>
<span class="c1">//    [animation setRepeatCount:HUGE_VALF];</span>
    <span class="n">CFRelease</span><span class="p">(</span><span class="n">path</span><span class="p">);</span>
    <span class="n">CAAnimationGroup</span> <span class="o">*</span><span class="n">animationGroup</span> <span class="o">=</span> <span class="p">[</span><span class="n">CAAnimationGroup</span> <span class="n">animation</span><span class="p">];</span><span class="c1">//利用动画组的间隔做到小动画的无限间隔之间的停顿</span>
    <span class="n">animationGroup</span><span class="p">.</span><span class="n">duration</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
    <span class="n">animationGroup</span><span class="p">.</span><span class="n">repeatCount</span> <span class="o">=</span> <span class="n">INFINITY</span><span class="p">;</span>
    <span class="n">animationGroup</span><span class="p">.</span><span class="n">animations</span><span class="o">=</span><span class="p">@[</span><span class="n">animation</span><span class="p">];</span>
    <span class="p">[</span><span class="n">animationGroup</span> <span class="n">setBeginTime</span><span class="o">:</span><span class="n">CACurrentMediaTime</span><span class="p">()</span><span class="o">+</span><span class="mf">0.5</span><span class="p">];</span><span class="c1">//让三个元素起始时间区分开</span>
    <span class="p">[</span><span class="n">red</span><span class="p">.</span><span class="n">layer</span> <span class="n">addAnimation</span><span class="o">:</span><span class="n">animationGroup</span> <span class="n">forKey</span><span class="o">:</span><span class="nb">NULL</span><span class="p">];</span>
    <span class="n">path</span><span class="o">=</span><span class="n">CGPathCreateMutable</span><span class="p">();</span>
    <span class="n">CGPathAddArc</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="mf">0.0f</span><span class="p">,</span> <span class="mf">200.0f</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.683</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.683</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">PI</span><span class="p">,</span> <span class="nb">NO</span><span class="p">);</span>
    <span class="n">CGPathAddArc</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="mf">0.0f</span><span class="p">,</span> <span class="mf">200.0f</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.683</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.783</span><span class="p">,</span> <span class="nb">YES</span><span class="p">);</span>
    <span class="n">animation</span><span class="o">=</span><span class="p">[</span><span class="n">CAKeyframeAnimation</span> <span class="n">animationWithKeyPath</span><span class="o">:</span><span class="s">@&quot;position&quot;</span><span class="p">];</span>
    <span class="p">[</span><span class="n">animation</span> <span class="n">setCalculationMode</span><span class="o">:</span><span class="n">kCAAnimationPaced</span><span class="p">];</span>
    <span class="p">[</span><span class="n">animation</span> <span class="n">setPath</span><span class="o">:</span><span class="n">path</span><span class="p">];</span>
    <span class="p">[</span><span class="n">animation</span> <span class="n">setDuration</span><span class="o">:</span><span class="mf">2.0f</span><span class="p">];</span>
    <span class="p">[</span><span class="n">animation</span> <span class="n">setTimingFunction</span><span class="o">:</span><span class="p">[</span><span class="n">CAMediaTimingFunction</span> <span class="n">functionWithName</span><span class="o">:</span><span class="n">kCAMediaTimingFunctionEaseInEaseOut</span><span class="p">]];</span>
<span class="c1">//    [animation setBeginTime:CACurrentMediaTime()+0.5];</span>
<span class="c1">//    [animation setRepeatCount:HUGE_VALF];</span>

    <span class="n">CFRelease</span><span class="p">(</span><span class="n">path</span><span class="p">);</span>
    <span class="n">animationGroup</span> <span class="o">=</span> <span class="p">[</span><span class="n">CAAnimationGroup</span> <span class="n">animation</span><span class="p">];</span><span class="o">&lt;</span><span class="n">br</span> <span class="o">/&gt;</span>
    <span class="n">animationGroup</span><span class="p">.</span><span class="n">duration</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span><span class="o">&lt;</span><span class="n">br</span> <span class="o">/&gt;</span>
    <span class="n">animationGroup</span><span class="p">.</span><span class="n">repeatCount</span> <span class="o">=</span> <span class="n">INFINITY</span><span class="p">;</span><span class="o">&lt;</span><span class="n">br</span> <span class="o">/&gt;</span>
    <span class="n">animationGroup</span><span class="p">.</span><span class="n">animations</span><span class="o">=</span><span class="p">@[</span><span class="n">animation</span><span class="p">];</span><span class="o">&lt;</span><span class="n">br</span> <span class="o">/&gt;</span>
    <span class="p">[</span><span class="n">animationGroup</span> <span class="n">setBeginTime</span><span class="o">:</span><span class="n">CACurrentMediaTime</span><span class="p">()</span><span class="o">+</span><span class="mf">0.2</span><span class="p">];</span><span class="o">&lt;</span><span class="n">br</span> <span class="o">/&gt;</span>
    <span class="p">[</span><span class="n">green</span><span class="p">.</span><span class="n">layer</span> <span class="n">addAnimation</span><span class="o">:</span><span class="n">animationGroup</span> <span class="n">forKey</span><span class="o">:</span><span class="nb">NULL</span><span class="p">];</span><span class="o">&lt;</span><span class="n">br</span> <span class="o">/&gt;</span>
    <span class="o">&lt;</span><span class="n">br</span> <span class="o">/&gt;</span>
    <span class="n">path</span><span class="o">=</span><span class="n">CGPathCreateMutable</span><span class="p">();</span><span class="o">&lt;</span><span class="n">br</span> <span class="o">/&gt;</span>
    <span class="n">CGPathAddArc</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="mf">0.0f</span><span class="p">,</span> <span class="mf">200.0f</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.425</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.425</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">PI</span><span class="p">,</span> <span class="nb">NO</span><span class="p">);</span><span class="o">&lt;</span><span class="n">br</span> <span class="o">/&gt;</span>
    <span class="n">CGPathAddArc</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="mf">0.0f</span><span class="p">,</span> <span class="mf">200.0f</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.425</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.525</span><span class="p">,</span> <span class="nb">YES</span><span class="p">);</span><span class="o">&lt;</span><span class="n">br</span> <span class="o">/&gt;</span>
    <span class="n">animation</span><span class="o">=</span><span class="p">[</span><span class="n">CAKeyframeAnimation</span> <span class="n">animationWithKeyPath</span><span class="o">:</span><span class="s">@&quot;position&quot;</span><span class="p">];</span><span class="o">&lt;</span><span class="n">br</span> <span class="o">/&gt;</span>
    <span class="p">[</span><span class="n">animation</span> <span class="n">setCalculationMode</span><span class="o">:</span><span class="n">kCAAnimationPaced</span><span class="p">];</span><span class="o">&lt;</span><span class="n">br</span> <span class="o">/&gt;</span>
    <span class="p">[</span><span class="n">animation</span> <span class="n">setPath</span><span class="o">:</span><span class="n">path</span><span class="p">];</span><span class="o">&lt;</span><span class="n">br</span> <span class="o">/&gt;</span>
    <span class="p">[</span><span class="n">animation</span> <span class="n">setDuration</span><span class="o">:</span><span class="mf">2.0f</span><span class="p">];</span><span class="o">&lt;</span><span class="n">br</span> <span class="o">/&gt;</span>
<span class="c1">//    [animation setRepeatCount:HUGE_VALF];&lt;/p&gt;</span>

    <span class="p">[</span><span class="n">animation</span> <span class="n">setTimingFunction</span><span class="o">:</span><span class="p">[</span><span class="n">CAMediaTimingFunction</span> <span class="n">functionWithName</span><span class="o">:</span><span class="n">kCAMediaTimingFunctionEaseInEaseOut</span><span class="p">]];</span>

    <span class="n">CFRelease</span><span class="p">(</span><span class="n">path</span><span class="p">);</span>
    <span class="n">animationGroup</span> <span class="o">=</span> <span class="p">[</span><span class="n">CAAnimationGroup</span> <span class="n">animation</span><span class="p">];</span>
    <span class="n">animationGroup</span><span class="p">.</span><span class="n">duration</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
    <span class="n">animationGroup</span><span class="p">.</span><span class="n">repeatCount</span> <span class="o">=</span> <span class="n">INFINITY</span><span class="p">;</span>
    <span class="n">animationGroup</span><span class="p">.</span><span class="n">animations</span><span class="o">=</span><span class="p">@[</span><span class="n">animation</span><span class="p">];</span>
    <span class="p">[</span><span class="n">yellow</span><span class="p">.</span><span class="n">layer</span> <span class="n">addAnimation</span><span class="o">:</span><span class="n">animationGroup</span> <span class="n">forKey</span><span class="o">:</span><span class="nb">NULL</span><span class="p">];</span>
<span class="p">}</span>

<span class="c1">// Only override drawRect: if you perform custom drawing.</span>
<span class="c1">// An empty implementation adversely affects performance during animation.</span>
<span class="k">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">drawRect:</span><span class="p">(</span><span class="n">CGRect</span><span class="p">)</span><span class="nv">rect</span>
<span class="p">{</span>
    <span class="n">CGContextRef</span> <span class="n">context</span> <span class="o">=</span> <span class="n">UIGraphicsGetCurrentContext</span><span class="p">();</span>
    <span class="n">CGContextSetStrokeColor</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="p">[</span><span class="n">UIColor</span> <span class="n">blueColor</span><span class="p">].</span><span class="n">CGColor</span><span class="p">);</span>
    <span class="n">CGContextAddArc</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">200.0f</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">PI</span><span class="p">,</span> <span class="nb">YES</span><span class="p">);</span>

    <span class="p">[[</span><span class="n">UIColor</span> <span class="n">orangeColor</span><span class="p">]</span> <span class="n">setFill</span><span class="p">];</span>
    <span class="p">[[</span><span class="n">UIColor</span> <span class="n">blueColor</span><span class="p">]</span> <span class="n">setStroke</span><span class="p">];</span>
    <span class="n">CGContextDrawPath</span> <span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">kCGPathStroke</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">@end</span>
</code></pre></div>
    </div>

  
    <ul class="tag_box inline">
      <li><i class="icon-folder-open"></i></li>
      
      


  
    
    	<li><a href="#program-ref">
    		program <span>43</span>
    	</a></li>
    
  



    </ul>
  

  
    <ul class="tag_box inline">
      <li><i class="icon-tags"></i></li>
      
      


  
    
  



    </ul>
  
  </div>
</div>


<div class="page-header">
  <h3><a href="/program/2013/07/29/ios%E6%9B%BF%E6%8D%A2%E7%B3%BB%E7%BB%9F%E6%96%B9%E6%B3%95">ios替换系统方法 </a></h3>
  <div class="date">
    <span>29 July 2013</span>
  </div>
</div>

<div class="row-fluid post-full">
  <div class="span12">
    <div class="content">
      <p><p>作为动态语言的oc我以前一直忽视了他的动态特性最近一个分享会才突然就有种飘逸的感觉<br />
主要使用的就是oc的runtime特性<br /></p>

<h1>import &quot;objc/runtime.h&quot;<br /></h1>

<p>引入这个头文件之后才发现动态远远不止我以前想的那么简单引入这个头文件后可以发现者真是海量的api能让代码写的真是自己都不认识都不过分<br />
然后就写一个例子来试验了<br />
比如 NSArray 里面的objetAtIndex 方法我想这个方法真是被无数人深恶痛绝……多少crash都是从这里搞出来的啊那么其实通过runtime完全可以重写这个方法、当然绝对不仅仅是简单的给他封一层那么简单<br />
首先你先需要找到这个方法是在哪儿的、最简单的方法就是故意越界让他报次错看看嘛Terminating app due to uncaught exception &#39;NSRangeException&#39;, reason: &#39;*** -[__NSArrayI objectAtIndex:]<br />
看到了吧就是 _NSArrayI里<br />
然后需要做的就是很简单了</p>

<p>Method method_ObjectAtIndex = class_getInstanceMethod(NSClassFromString(@&quot;_<em>NSArrayI&quot;),@selector(objectAtIndex:));
Method method_SafeObjectAtIndex = class_getInstanceMethod(NSClassFromString(@&quot;NSArray&quot;),@selector(safeObjectAtIndex:));//这个方法就是一会自己写的拓展进nsarray中的
method_exchangeImplementations(method</em>ObjectAtIndex, method_SafeObjectAtIndex);//然后交换就是这么简单 不过这个危险性也是极大的比如整个系统所有的调用这个原生api的调用就全都走到你这来了、必须必须要确保正确性……</p>

<p>//然后就简单的加个category的实现就好了
@implementation NSArray(SafeExtenstion)
- (id)safeObjectAtIndex:(NSUInteger)index
{
    NSLog(@&quot;wake %@--%@&quot;,NSStringFromSelector(_cmd),self);
    if (self.count
    return [self safeObjectAtIndex:index];
}
@end</p>

<p>这样就可以自己去复写掉一些认为系统实现的很傻逼的方法了吧、runtime的适用场景我想还远远不止这些呢</p>

<blockquote>
</blockquote>

    </div>

  
    <ul class="tag_box inline">
      <li><i class="icon-folder-open"></i></li>
      
      


  
    
    	<li><a href="#program-ref">
    		program <span>43</span>
    	</a></li>
    
  



    </ul>
  

  
    <ul class="tag_box inline">
      <li><i class="icon-tags"></i></li>
      
      


  
    
  



    </ul>
  
  </div>
</div>


<div class="page-header">
  <h3><a href="/program/2013/06/24/%E5%AE%9A%E5%88%B6-uipagecontrol">定制 UIPageControl </a></h3>
  <div class="date">
    <span>24 June 2013</span>
  </div>
</div>

<div class="row-fluid post-full">
  <div class="span12">
    <div class="content">
      <p><p>pagecontrol 就是iphone上面比如scrollview翻图片时候下面那个小点点<br />
其实我个人觉得还是挺美观的……可是需求就是要自己的图片替掉……然后死人苹果又不给api、所以也就只能自己复写实现了<br />
先说下ios7之前 那些点点的实现非常简单 就是UIPageControl.subviews 就是一个个点的UIImageView 所以只需简单的替换掉就好了代码如下</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">@property(nonatomic,strong)UIImage *_activeImage;
@property(nonatomic,strong)UIImage *_inactiveImage;
//在init的时候把你自己定义的两张图片搞进去
- (void)updateDots
{
    for (int i = 0; i

        if (i == self.currentPage) {
            if ([dot respondsToSelector:@selector(setImage:)]) {
                dot.image=_activeImage;
            }

        } else {
            if ([dot respondsToSelector:@selector(setImage:)]) {
                dot.image=_inactiveImage;
            }
        }
    }
}
//然后自己重载一下setNumber就好了

- (void)setNumberOfPages:(NSInteger)numberOfPages
{
    [super setNumberOfPages:numberOfPages];
    [self updateDots];
}

但是呢万恶的ios7改掉了尼玛……连底层实现都改啊混蛋……可以对self.subviews 标红一下就明白了……整个pagecontrol的uivew乱七八糟……而且都是view根本就没了image属性、换句话说现在的那些小点点都是代码写出来的了、而不是简单图了
实现起来就要重写UIView的绘画函数了代码大致如下

#import &quot;ZDPageControll.h&quot;
#import

@interface ZDPageControll()
{
    UIImage *_activeImage;
    UIImage *_inactiveImage;
    NSArray *_usedToRetainOriginalSubview;
}

@end

@implementation ZDPageControll
@synthesize kSpacing=_kSpacing;
- (id)initWithFrame:(CGRect)frame currentImageName:(NSString *)current commonImageName:(NSString *)common
{
    self= [super initWithFrame:frame];
    if ([self respondsToSelector:@selector(setCurrentPageIndicatorTintColor:)] &amp;&amp; [self respondsToSelector:@selector(setPageIndicatorTintColor:)]) {
        [self setCurrentPageIndicatorTintColor:[UIColor clearColor]];
        [self setPageIndicatorTintColor:[UIColor clearColor]];
    }

    [self setBackgroundColor:[UIColor clearColor]];
    _activeImage= [UIImage imageNamed:current];
    _inactiveImage= [UIImage imageNamed:common];
    _kSpacing=10.0f;
    //hold住原来pagecontroll的subview
    _usedToRetainOriginalSubview=[NSArray arrayWithArray:self.subviews];
    for (UIView *su in self.subviews) {
        [su removeFromSuperview];
    }
    self.contentMode=UIViewContentModeRedraw;
    return self;
}
-(void)dealloc
{
    //释放原来hold住的那些subview
    _usedToRetainOriginalSubview=nil;
    _activeImage=nil;
    _inactiveImage=nil;
}
- (void)updateDots
{

    for (int i = 0; i
        UIImageView* dot =[self.subviews objectAtIndex:i];

        if (i == self.currentPage) {
            if ([dot respondsToSelector:@selector(setImage:)]) {
                dot.image=_activeImage;
            }

        } else {
            if ([dot respondsToSelector:@selector(setImage:)]) {
                dot.image=_inactiveImage;
            }
        }
    }

}

- (void)setCurrentPage:(NSInteger)currentPage
{
    [super setCurrentPage:currentPage];
    if ([[[UIDevice currentDevice]systemVersion]floatValue]
        [self updateDots];
    }
//    [self updateDots];
    [self setNeedsDisplay];
}
- (void)setNumberOfPages:(NSInteger)numberOfPages
{
    [super setNumberOfPages:numberOfPages];
    if ([[[UIDevice currentDevice]systemVersion]floatValue]
        [self updateDots];
    }
//    [self updateDots];
    [self setNeedsDisplay];

}
-(void)drawRect:(CGRect)iRect
{
    int i;
    CGRect rect;

    UIImage *image;
    iRect = self.bounds;

    if ( self.opaque ) {
        [self.backgroundColor set];
        UIRectFill( iRect );
    }

    if ( self.hidesForSinglePage &amp;&amp; self.numberOfPages == 1 ) return;

    rect.size.height = _activeImage.size.height;
    rect.size.width = self.numberOfPages * _activeImage.size.width + ( self.numberOfPages - 1 ) * _kSpacing;
    rect.origin.x = floorf( ( iRect.size.width - rect.size.width ) / 2.0 );
    rect.origin.y = floorf( ( iRect.size.height - rect.size.height ) / 2.0 );
    rect.size.width = _activeImage.size.width;

    for ( i = 0; i
        image = i == self.currentPage ? _activeImage : _inactiveImage;

        [image drawInRect: rect];

        rect.origin.x += _activeImage.size.width + _kSpacing;
    }
}
@end


&gt;
</code></pre></div>
    </div>

  
    <ul class="tag_box inline">
      <li><i class="icon-folder-open"></i></li>
      
      


  
    
    	<li><a href="#program-ref">
    		program <span>43</span>
    	</a></li>
    
  



    </ul>
  

  
    <ul class="tag_box inline">
      <li><i class="icon-tags"></i></li>
      
      


  
    
  



    </ul>
  
  </div>
</div>


<!-- </ul> -->

<div id="post-pagination" class="paginator">

  
    <span class="previous disabled">前页</span>
  

      
      <span class="current-page">1</span>
      

    
      
      <a href="/page2">2</a>
      
    
      
      <a href="/page3">3</a>
      
    
      
      <a href="/page4">4</a>
      
    
      
      <a href="/page5">5</a>
      
    
      
      <a href="/page6">6</a>
      
    

  
    <a class="next" href="/page2">后页</a>
  
  (共55篇)
</div>

        </div>
        <hr>
        <footer>
          <p>&copy; 2014 Xinzheng ZhangPowered by Jekyll @ GitHub
          </p>
        </footer>

      </div>
    </div>
    
  </body>
</html>

