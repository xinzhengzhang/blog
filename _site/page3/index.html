
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>snorlax's Homepage</title>
    
    <meta name="author" content="Xinzheng Zhang">

    <!-- Enable responsive viewport -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le styles -->
    <link href="/assets/themes/twitter/bootstrap/css/bootstrap.2.2.2.min.css" rel="stylesheet">
    <link href="/assets/themes/twitter/css/style.css?body=1" rel="stylesheet" type="text/css" media="all">
    <link href="/assets/themes/twitter/css/pygments.css?body=1" rel="stylesheet" type="text/css" media="all">
    <!-- Le fav and touch icons -->
  <!-- Update these with your own images
    <link rel="shortcut icon" href="images/favicon.ico">
    <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
  -->

    <!-- atom & rss feed -->
    <link href="" type="application/atom+xml" rel="alternate" title="Sitewide ATOM Feed">
    <link href="/rss.xml" type="application/rss+xml" rel="alternate" title="Sitewide RSS Feed">

  </head>

  <body>
    <div class="navbar">
      <div class="navbar-inner">
        <div class="container-narrow">
          <a class="brand" href="/">Snorlax's blog</a>
          <ul class="nav">
            
            
            


  
    
      
      	
      	<li><a href="/about.html">About me</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/archive.html">Archives</a></li>
      	
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  




          </ul>
        </div>
      </div>
    </div>
    <div class="container_wrapper">
      <div class="container-narrow">
        <div class="content">
          <!-- <ul class="listing"> -->

<div class="page-header">
  <h3><a href="/%E6%9C%AA%E5%88%86%E7%B1%BB/2013/01/29/%E5%85%B3%E4%BA%8Ewindows%E9%87%8C%E7%9A%84python%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE">关于windows里的python环境配置 </a></h3>
  <div class="date">
    <span>29 January 2013</span>
  </div>
</div>

<div class="row-fluid post-full">
  <div class="span12">
    <div class="content">
      <p>首先windows下面没有类似bpython、ipython等神器……<br />
很小很小的东西当然可以用sublime text2但是稍微复杂点的没有一个好点的ide还是不行的<br />
先是推荐一个不错的ide是jetbrains做的pycharm、根据这牌子名可想而知肯定是不错的啦、但可惜人家是收费的（当盗版狗是不好的行为……<br />
然后选择了eclipse+pydev、试用了下效果还是非常不错的（应该是新电脑跑eclispe非常流畅的缘故了啦（¯﹃¯）<br />
个么要装分别就是<br />
1.Java http://www.java.com/zh_CN/download/index.jsp<br />
2.Jdk http://www.oracle.com/technetwork/java/javase/downloads/index.html<br />
3.eclipse http://www.eclipse.org/downloads/<br />
4.pvDev http://pydev.org/manual_101_install.html (其中尤其要关注一下 Then, UNCHECK the 'Contact all update sites during install to find required software' and press<br />
'Next' again to confirm your selection. 把那个钩子要去掉的因为这个失败了好多次<br />
5.python http://python.org/download/<br />
分别全装完之后还剩下最后就是要在eclipse里设置python解释器的路径了<br />
6.windows->perferences->PyDev->Interpereter-Python 设置5中python的路径</p>

<p>enjoy</p>

<p>ps.切记1 2 3步的要么全是32位要么全是64 因为64位机能够很成功自然得装上32位的Java然后再eclipse里会加载jvm.dll是出错……详见http://stackoverflow.com/questions/7352493/failed-to-load-the-jni-shared-library-jdk</p>

<p></p>

    </div>

  
    <ul class="tag_box inline">
      <li><i class="icon-folder-open"></i></li>
      
      


  
    
    	<li><a href="#未分类-ref">
    		未分类 <span>3</span>
    	</a></li>
    
  



    </ul>
  

  
    <ul class="tag_box inline">
      <li><i class="icon-tags"></i></li>
      
      


  
    
  



    </ul>
  
  </div>
</div>


<div class="page-header">
  <h3><a href="/%E6%9C%AA%E5%88%86%E7%B1%BB/2013/01/21/%E5%85%B3%E4%BA%8E%E5%A4%84%E7%90%86%E6%8E%89urllib2%E4%B8%AD%E7%9A%84%E9%94%99%E8%AF%AF%E6%8F%90%E7%A4%BA%E5%BC%82%E5%B8%B8">关于处理掉urllib2中的错误提示异常 </a></h3>
  <div class="date">
    <span>21 January 2013</span>
  </div>
</div>

<div class="row-fluid post-full">
  <div class="span12">
    <div class="content">
      <p><p>在很多情况下如果server帮着redirect一下什么的、如果还使用urllib2的urlopen非常容易抛出异常、而且既然人家给你跳转了你照着搬不就完了么混蛋……<br />
然后下面讲下怎么除掉掉这些异常其实很简单<br />
再构建的时候对urllib2.HTTPCookieProcessor进行复写、把里面的异常的地方给复写掉<br />
代码如下</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">class NoExceptionCookieProcesser(urllib2.HTTPCookieProcessor):
    def http_error_500(self, req, fp, code, msg, hdrs):
        return fp

以此类推想弄掉哪儿些复写掉即可
然后构造的时候

cookie = cookielib.CookieJar()
opener = urllib2.build_opener(NoExceptionCookieProcesser(cookie))

行了、这样讨厌的异常就搞定了
&gt;
</code></pre></div>
    </div>

  
    <ul class="tag_box inline">
      <li><i class="icon-folder-open"></i></li>
      
      


  
    
    	<li><a href="#未分类-ref">
    		未分类 <span>3</span>
    	</a></li>
    
  



    </ul>
  

  
    <ul class="tag_box inline">
      <li><i class="icon-tags"></i></li>
      
      


  
    
  



    </ul>
  
  </div>
</div>


<div class="page-header">
  <h3><a href="/program/2013/01/07/%E5%85%B3%E4%BA%8E%E5%B5%8C%E5%A5%97%E4%B8%8Euiscrollview%E4%B8%AD%E7%9A%84uitableview%E7%9A%84%E5%86%B2%E7%AA%81%E8%A7%A3%E5%86%B3">关于嵌套与UIScrollView中的UITableVIew的冲突解决 </a></h3>
  <div class="date">
    <span>07 January 2013</span>
  </div>
</div>

<div class="row-fluid post-full">
  <div class="span12">
    <div class="content">
      <p><p>周知tableview是继承自scrollview的、一旦如果在scrollview上add上子的table那么双方的滚动就冲突了、只能选择其一、apple的文档里也讲了两者是冲突的不要加子table到scroll上、但是发现其实还是有解决方法的<br />
首先的关键点就是禁掉两方的任意一个ScrollEnabled另一方就可以滚动了、所以就从这下手其实思路也非常简单、就是给table加一个gesture、捕捉提前捕捉事件然后禁掉背的scroll的滚动话不多讲上代码</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">- (void)viewDidLoad
{
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.
    scr=[[UIScrollView alloc]initWithFrame:CGRectMake(0, 0, 320, 440)];
    scr.delegate=self;
    [scr setContentSize:CGSizeMake(320, 800)];
    [scr setDelaysContentTouches:YES];//记得这里要把延迟触摸设成yes
    UIView *pand=[[UIView alloc]initWithFrame:CGRectMake(0, 0, 320, 800)];
    [pand setBackgroundColor:[UIColor redColor]];
    tableView=[[UITableView alloc]initWithFrame:CGRectMake(0, 0, 320, 440)];
    tableView.dataSource=self;
    tableView.delegate=self;
    UILongPressGestureRecognizer *ge=[[UILongPressGestureRecognizer alloc]initWithTarget:self action:@selector(cancelScroll:)];
    [ge setDelegate:self];
    [ge setMinimumPressDuration:0.1];//这里为了让他在tableview还是能够进行整个scroll的拖动所以用了0.1给用户一个快速拖动
    [tableView addGestureRecognizer:ge];
    [self.view addSubview:scr];
    [scr addSubview:pand];
    [scr addSubview:tableView];
}

然后是回调

-(BOOL)gestureRecognizer:(UIGestureRecognizer *)gestureRecognizer shouldRecognizeSimultaneouslyWithGestureRecognizer:(UIGestureRecognizer *)otherGestureRecognizer
{
    //切记这个代理必须要设置、因为scroll的拖动说白了也是一个gesture、为了流畅性必须要两个触碰事件同时触发
    return YES;
}
-(void)cancelScroll:(UIGestureRecognizer*)gesture
{
    //这里就是让背景的拖动定死这样就不冲突了
    if ([gesture state]==UIGestureRecognizerStateBegan) {
        [scr setScrollEnabled:NO];
    }

}
-(void)scrollViewDidEndDragging:(UIScrollView *)scrollView willDecelerate:(BOOL)decelerate
{
    //拖动完再恢复
    [scr setScrollEnabled:YES];
}

&gt;
</code></pre></div>
    </div>

  
    <ul class="tag_box inline">
      <li><i class="icon-folder-open"></i></li>
      
      


  
    
    	<li><a href="#program-ref">
    		program <span>39</span>
    	</a></li>
    
  



    </ul>
  

  
    <ul class="tag_box inline">
      <li><i class="icon-tags"></i></li>
      
      


  
    
  



    </ul>
  
  </div>
</div>


<div class="page-header">
  <h3><a href="/%E7%9E%8E%E5%86%99%E5%86%99/2013/01/01/rc4-python%E5%AE%9E%E7%8E%B0">rc4 python实现 </a></h3>
  <div class="date">
    <span>01 January 2013</span>
  </div>
</div>

<div class="row-fluid post-full">
  <div class="span12">
    <div class="content">
      <p>复习密码无事写了个rc4、早上随便说点新年愿望其实也有个就写里面了……</p>

<p>闲得蛋疼得就解了吧（不过tm简单过份了吧喂！</p>

<p><a href="http://snorlax-wordpress.stor.sinaapp.com/uploads/2013/01/734420E9-D793-4822-9B07-01A783B74818.jpg"><img class="alignnone size-full wp-image-174" title="734420E9-D793-4822-9B07-01A783B74818" src="http://snorlax-wordpress.stor.sinaapp.com/uploads/2013/01/734420E9-D793-4822-9B07-01A783B74818.jpg" alt="" width="523" height="551" /></a></p>

    </div>

  
    <ul class="tag_box inline">
      <li><i class="icon-folder-open"></i></li>
      
      


  
    
    	<li><a href="#瞎写写-ref">
    		瞎写写 <span>4</span>
    	</a></li>
    
  



    </ul>
  

  
    <ul class="tag_box inline">
      <li><i class="icon-tags"></i></li>
      
      


  
    
  



    </ul>
  
  </div>
</div>


<div class="page-header">
  <h3><a href="/program/2012/12/23/os-x-%E7%9A%84%E5%90%AF%E5%8A%A8%E9%A1%B9">os x 的启动项 </a></h3>
  <div class="date">
    <span>23 December 2012</span>
  </div>
</div>

<div class="row-fluid post-full">
  <div class="span12">
    <div class="content">
      <p>每次开机总要开几个脚本开烦了、然后研究了下自己机器的几个开机自启的程序的写法总结了下</p>

<p>首先是这个目录 然后我分别展开了/Library/StartupItems 以及集中的mysql可以看到里面就是主要一个是StartupParameters.plist 以及一个sh</p>

<p><a href="http://snorlax-wordpress.stor.sinaapp.com/uploads/2012/12/8460C8BA-D46E-4C02-B3B6-01AF84D6F28E.jpg"><img class="alignnone size-full wp-image-167" title="8460C8BA-D46E-4C02-B3B6-01AF84D6F28E" src="http://snorlax-wordpress.stor.sinaapp.com/uploads/2012/12/8460C8BA-D46E-4C02-B3B6-01AF84D6F28E.jpg" alt="" width="501" height="69" /></a></p>

<p>然后解释下里面分别怎么写</p>

<p><p>首先是 StartupParameters.plist这个xml里面的内容大致是</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">&amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&amp;gt;
&amp;lt;!DOCTYPE plist PUBLIC &quot;-//Apple Computer//DTD PLIST 1.0//EN&quot; &quot;http://www.apple.com/DTDs/PropertyList-1.0.dtd&quot;&amp;gt;
&amp;lt;plist version=&quot;1.0&quot;&amp;gt;
&amp;lt;dict&amp;gt;
    &amp;lt;key&amp;gt;Description&amp;lt;/key&amp;gt;
    &amp;lt;string&amp;gt;MySQL 5.5.20-community&amp;lt;/string&amp;gt;
    &amp;lt;key&amp;gt;OrderPreference&amp;lt;/key&amp;gt;
    &amp;lt;string&amp;gt;None&amp;lt;/string&amp;gt;
    &amp;lt;key&amp;gt;Provides&amp;lt;/key&amp;gt;
    &amp;lt;array&amp;gt;
        &amp;lt;string&amp;gt;MySQL&amp;lt;/string&amp;gt;
    &amp;lt;/array&amp;gt;
    &amp;lt;key&amp;gt;Uses&amp;lt;/key&amp;gt;
    &amp;lt;array&amp;gt;
        &amp;lt;string&amp;gt;Network&amp;lt;/string&amp;gt;
        &amp;lt;string&amp;gt;Resolver&amp;lt;/string&amp;gt;
    &amp;lt;/array&amp;gt;
    &amp;lt;/dict&amp;gt;
&amp;lt;/plist&amp;gt;
主要有几个key description OrderPreference Provides Uses
具体是什么如下
&quot;Description&quot; is a simple description of the service, which is only used to describe the file and not during the startup process.

&quot;Provides&quot; specifies the services that this StartupItems provides. Provides can contain multiple services, but it is not recommended. Here Apache provides a &quot;Web Server&quot; service.

&quot;Requires&quot; specifies the services that have to be started before this StartupItem is loaded. The values in this field are those of other StartupItems&#39; &quot;Provides&quot; fields. Apache requires &quot;DirectoryServices&quot; to be loaded before it can be run; if DirectoryServices are not specified to run or fail to run properly Apache won&#39;t run.

&quot;Uses&quot; specifics the services that should be started before this StartupItem is loaded. This is similar to the &quot;Requires&quot; attribute except this service will always be loaded, but only after it has tried to execute all the services in &quot;Uses&quot;. Apache uses the &quot;Disks&quot;, &quot;NFS&quot;, and &quot;Network Time&quot; services. OS X will try to load these services, if it can&#39;t it will still load Apache, but only after trying these services first.

&quot;OrderPreference&quot; specifies the general time period in which a StartupItem will be executed. This order is less significant than both &quot;Requires&quot; and &quot;Uses&quot; but is used to determine order after evaluating those attributes. The possible values for this attribute are: First, Early, None (default), Late, Last. Apache specifies no OrderPreference as to when it should be loaded.

然后就是写的脚本了

简单点的写法就这样
#!/bin/sh
. /etc/rc.common

StartService ()
{
    ConsoleMessage &quot;Running script.&quot;
    python /Users/zxz/work/xxxx.py
}

StopService ()
{
    return 0
}

RestartService ()
{
    return 0
}

RunService &quot;$1&quot;
里面的shell就随意怎么写了

然后正常的 start stop restart也都可以正常用了

ps.最后记得注意要修改脚本的权限……chown root:wheel chmod 755
&gt;
</code></pre></div>
    </div>

  
    <ul class="tag_box inline">
      <li><i class="icon-folder-open"></i></li>
      
      


  
    
    	<li><a href="#program-ref">
    		program <span>39</span>
    	</a></li>
    
  



    </ul>
  

  
    <ul class="tag_box inline">
      <li><i class="icon-tags"></i></li>
      
      


  
    
  



    </ul>
  
  </div>
</div>


<div class="page-header">
  <h3><a href="/program/2012/12/07/%E7%9B%B8%E4%BC%BC%E5%9B%BE%E7%89%87%E6%90%9C%E7%B4%A2python%E5%AE%9E%E7%8E%B0">相似图片搜索python实现 </a></h3>
  <div class="date">
    <span>07 December 2012</span>
  </div>
</div>

<div class="row-fluid post-full">
  <div class="span12">
    <div class="content">
      <p><p>先贴原文<a href="http://blog.csdn.net/luohong722/article/details/7100058">http://blog.csdn.net/luohong722/article/details/7100058</a><br />
其实这篇文章已经写的非常详细了、不过也作为巩固自己再梳理一遍<br />
首先这个算法的流程简直简单的令人发指、导致我做的时候完全不觉得这真的可能搜索出什么东西来……<br />
几步流程分别如下<br />
1.压缩成8*8的小图<br />
2.灰化<br />
3.算均值二值化<br />
4.生成64位标示码<br />
5.比较标示码 越接近越相似<br />
貌似好像应该是sift算法的简便吧（也不能简便成这样啊……<br />
---------------------------下面是程序主要逻辑一共就十几行--------------------------<br />
主要用到了python的PIL库</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">from PIL import Image
def picHash(im):
    if not isinstance(im, Image.Image):
        im = Image.open(im)
    #平滑的压成8*8 并灰化
    im = im.resize((8, 8), Image.ANTIALIAS).convert(&#39;L&#39;)
    avg = reduce(lambda x, y: x + y, im.getdata()) / 64.0
    return map(lambda i: 0 if i &amp;lt; avg else 1, im.getdata())

def diffCount(h1,h2):
    h=0
    for i in range(64):
       if h1[i]!=h2[i]:
           h+=1
    return h
然后呢……然后没了……就是那么简单……最后发一下效果图
图片样本20张
最后搜出的近似度前5的左上为搜索原图

效果还是非常不错的、样本里只有一张未被选出
&gt;
</code></pre></div>
    </div>

  
    <ul class="tag_box inline">
      <li><i class="icon-folder-open"></i></li>
      
      


  
    
    	<li><a href="#program-ref">
    		program <span>39</span>
    	</a></li>
    
  



    </ul>
  

  
    <ul class="tag_box inline">
      <li><i class="icon-tags"></i></li>
      
      


  
    
  



    </ul>
  
  </div>
</div>


<div class="page-header">
  <h3><a href="/program/2012/12/07/%E5%85%B3%E4%BA%8Epython%E5%9B%BE%E5%BD%A2%E5%BA%93pil%E5%9C%A8mac-os%E4%B8%8B%E7%9A%84%E5%AE%89%E8%A3%85">关于python图形库pil在mac os下的安装 </a></h3>
  <div class="date">
    <span>07 December 2012</span>
  </div>
</div>

<div class="row-fluid post-full">
  <div class="span12">
    <div class="content">
      <p>首先在mac os的环境下根据官方给出的release版本
<a href="http://effbot.org/downloads/Imaging-1.1.7.tar.gz" title="Python Imaging Library 1.1.7 Source Kit ">Python Imaging Library 1.1.7 Source Kit</a> <br />
如果在debian下可以非常简便的就<br />
sudo apt-get install libjpeg62-dev<br />
sudo apt-get install zlib1g-dev<br />
sudo apt-get install libfreetype6-dev<br />
sudo apt-get install liblcms1-dev<br />
然后就 python setup.py install 轻松又愉快<br />
可是mac的说明我有点蒙</p>

<p>--------------------------------------------------------------------<br />
Additional notes for Mac OS X<br />
--------------------------------------------------------------------</p>

<p>On Mac OS X you will usually install additional software such as<br />
libjpeg or freetype with the "fink" tool, and then it ends up in<br />
"/sw".  If you have installed the libraries elsewhere, you may have<br />
to tweak the "setup.py" file before building.</p>

<p>反正我一开始也就理所当然的当成usually install additional software的一份子了、当然结果肯定是残忍的<br />
pil是可以用但是任何的解析基本都会报类似<br />
raise IOError decoder s not available decoder_name IOError decoder jpeg not available的错</p>

<p>google了无数各种做ln连来连去的……<br />
注意一点就是 3一下的版本都在 /System/Library/Frameworks/Python.framework/Versions/下<br />
3以上的版本都在 /Library/Frameworks/Python.framework/Versions<br />
然后site-package<br />
分别在<br />
/Library/Python/2.7/site-packages<br />
/Library/Python/2.3/site-packages<br />
/usr/local/git/lib/python2.7/site-packages<br />
/Library/Python/2.5/site-packages<br />
/Library/Python/2.6/site-packages<br />
/Library/Frameworks/Python.framework/Versions/3.2/lib/python3.2/site-packages<br />
/usr/local/lib/python3.2/site-packages<br />
混乱了吧……记得你装的是哪儿个版本、然后在configure之前要都设置对路径……私认为这绝对是太残忍了……<br />
-----------------------------------分割线--------------------------------------<br />
下面是经过实践出的最简单的方法、就用python自带的easy_install里的pip这样默认都帮你configure完了也不用你纠结了<br />
就这么几句就搞定了<br />
sudo easy_install pip<br />
sudo brew install jpeg<br />
sudo brew install libjpeg<br />
sudo pip uninstall pil<br />
sudo pip install pil</p>

<p>搞定记得顺序、先要装依赖</p>

<p>附上PIL的文档:<br />
http://www.pythonware.com/library/pil/handbook/index.htm</p>

    </div>

  
    <ul class="tag_box inline">
      <li><i class="icon-folder-open"></i></li>
      
      


  
    
    	<li><a href="#program-ref">
    		program <span>39</span>
    	</a></li>
    
  



    </ul>
  

  
    <ul class="tag_box inline">
      <li><i class="icon-tags"></i></li>
      
      


  
    
  



    </ul>
  
  </div>
</div>


<div class="page-header">
  <h3><a href="/program/2012/12/04/ios-safari5-webview%E5%AF%B9-contenteditable-%E7%9A%84%E4%BF%AE%E6%AD%A3">ios safari5 webview对 contenteditable 的修正 </a></h3>
  <div class="date">
    <span>04 December 2012</span>
  </div>
</div>

<div class="row-fluid post-full">
  <div class="span12">
    <div class="content">
      <p>自从上次发现了html5的神器标签contenteditable后一直忽视了一个问题、因为一直跑的机器都是ios6（六毫无问题）、当放到5时出一个很大的问题、每次进入编辑时焦点会被放到整个body的最上面、毫无疑问这个糟糕的体验是不可能让用户自己去解决的所以需要解决。</p>

<p>首先先是native和js交互的问题、也许js太过庞大、webview完全没有做任何关于js callback的api、唯一只有一个<br />
- (NSString *)stringByEvaluatingJavaScriptFromString:(NSString *)script;<br />
只能往里插js却获不得回调、这样没人性的行为绝对是无法容忍的、竟然phonegap什么的可以就一定有解决途径。<br />
既然js无法获得回调、就从webview的回调入手、查了他的三个delegate后办法有了、就是更改document.location加一个?xx=xx相当于一个get请求、然后通过回调去拿到xx然后做native<br />
可是这样我马上就发现了不适宜contenteditable的一个问题、就是一个点击事件同时触发了编辑以及跳转事件后、后者覆盖了前者、网上主流说的也是这个方法、找了半天终于找到了替代法<a href="http://blog.devtang.com/blog/2012/03/24/talk-about-uiwebview-and-phonegap/"></a>详见最后的这段js代码、最后需要做的就是给需要编辑的标签绑定上事件 通过鼠标的点击拿到pageY的偏移量 通过uiwebview.uiscrollview setContentOffset来调整偏移量即可修复safari5对contenteditable这极不友好的支持、代码如下</p>

<p>
```

var edit = document.getElementById(\"editable\");edit.addEventListener(\"click\",function(e){var iFrame;iFrame = document.createElement(\"iframe\");iFrame.setAttribute(\"src\", \"noteOffset:\"+e.pageY);iFrame.setAttribute(\"style\", \"display:none;\");iFrame.setAttribute(\"height\", \"0px\");iFrame.setAttribute(\"width\", \"0px\");iFrame.setAttribute(\"frameborder\", \"0\");document.body.appendChild(iFrame);iFrame.parentNode.removeChild(iFrame);iFrame = null;}, false);

然后在回调中写

#pragma UIWebViewDelegate
-(BOOL)webView:(UIWebView *)webView shouldStartLoadWithRequest:(NSURLRequest *)request navigationType:(UIWebViewNavigationType)navigationType
{
    NSLog(@"------");
    NSLog(@"%@",[[request URL]absoluteString]);
    if ([[[request URL]absoluteString]judgeNoteBodyEditMode] && [[request URL]absoluteString].length>>3) {
        
        NSLog(@"%d",[[[[request URL]absoluteString]substringFromIndex:[[request URL]absoluteString].length-3]integerValue]);
        [showRichText.scrollView setContentOffset:CGPointMake(showRichText.scrollView.contentOffset.x,[[[[request URL]absoluteString]substringFromIndex:[[request URL]absoluteString].length-3]integerValue])];
    }
    return YES;
}
</pre></p>

    </div>

  
    <ul class="tag_box inline">
      <li><i class="icon-folder-open"></i></li>
      
      


  
    
    	<li><a href="#program-ref">
    		program <span>39</span>
    	</a></li>
    
  



    </ul>
  

  
    <ul class="tag_box inline">
      <li><i class="icon-tags"></i></li>
      
      


  
    
  



    </ul>
  
  </div>
</div>


<div class="page-header">
  <h3><a href="/program/2012/12/03/ios%E5%87%A0%E7%A7%8D%E5%9F%BA%E6%9C%AC%E8%A7%86%E5%9B%BE%E5%88%87%E6%8D%A2%E5%8A%A8%E7%94%BB%E5%B0%8F%E7%BB%93">ios几种基本视图切换动画小结 </a></h3>
  <div class="date">
    <span>03 December 2012</span>
  </div>
</div>

<div class="row-fluid post-full">
  <div class="span12">
    <div class="content">
      <p>搞清楚试图首先先要搞清UIWindows UIView CALayer 这几者的关系<br />
推荐两篇文章
<a href="http://blog.csdn.net/holydancer/article/details/7422365">http://blog.csdn.net/holydancer/article/details/7422365</a>
<a href="http://www.cnblogs.com/lovecode/articles/2249548.html">http://www.cnblogs.com/lovecode/articles/2249548.html</a>
在理解的基础上上就是几个常用的切换了<br />
首先如果整体用的是navigationcontroller 的话常用的就是这三组方法

```

- (void)pushViewController:(UIViewController *)viewController animated:(BOOL)animated; // Uses a horizontal slide transition. Has no effect if the view controller is already in the stack.

- (UIViewController *)popViewControllerAnimated:(BOOL)animated; // Returns the popped controller.
- (NSArray *)popToViewController:(UIViewController *)viewController animated:(BOOL)animated; // Pops view controllers until the one specified is on top. Returns the popped controllers.
- (NSArray *)popToRootViewControllerAnimated:(BOOL)animated; // Pops until there's only a single view controller left on the stack. Returns the popped controllers.


这三种的切换效果基本都是左右推送那种感觉

再然后是用这两组切换

- (void)presentViewController:(UIViewController *)viewControllerToPresent animated: (BOOL)flag completion:(void (^)(void))completion NS_AVAILABLE_IOS(5_0);
// The completion handler, if provided, will be invoked after the dismissed controller's viewDidDisappear: callback is invoked.
- (void)dismissViewControllerAnimated: (BOOL)flag completion: (void (^)(void))completion NS_AVAILABLE_IOS(5_0);

// Display another view controller as a modal child. Uses a vertical sheet transition if animated.This method has been replaced by presentViewController:animated:completion:
- (void)presentModalViewController:(UIViewController *)modalViewController animated:(BOOL)animated NS_DEPRECATED_IOS(2_0, 6_0);

// Dismiss the current modal child. Uses a vertical sheet transition if animated. This method has been replaced by dismissViewControllerAnimated:completion:
- (void)dismissModalViewControllerAnimated:(BOOL)animated NS_DEPRECATED_IOS(2_0, 6_0);


这几种的默认的动画是上下卷（翻？）
最简单的更改动画方式就是在下一层需要切换的试图上使用 setModalTransitionStyle 方法可以设置为以下几种效果

UIModalTransitionStyleCoverVertical = 0,//垂直上下（默认那种）    UIModalTransitionStyleFlipHorizontal, //翻页

    UIModalTransitionStyleCrossDissolve, //淡出

#if __IPHONE_OS_VERSION_MAX_ALLOWED >>= __IPHONE_3_2</p>

<p>    UIModalTransitionStylePartialCurl, //立体</p>

<p></p>

<p><p>再然后如果需要更加精细的定制动画那么就要动用上#import <QuartzCore/QuartzCore.h>了在framework中加入QuartzCore然后使用CATransition对layer进行设置、这段代码一半可以加在viewWillAppear viewWillDisapper这两个地方中使用、大致的用法如下</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">        CATransition *animation=[CATransition animation];
        animation.delegate = self;
        animation.duration = 0.1f;//动画运行时间
        animation.timingFunction = UIViewAnimationCurveEaseInOut;//动画的时间分布（平均、两头快、快到慢等）
        animation.fillMode =  kCAFillModeForwards;//(填充的方式)
        animation.type = kCATransitionPush;//(动画覆盖过去的样子比如push movein等)
        animation.subtype = kCATransitionFromLeft;//(动画的方向)
        [self.view.layer addAnimation:animation forKey:@&quot;animation&quot;];//给这张view的layer层添加这个动画并给个key一会用来删除
        [self.view.layer removeAnimationForKey:@&quot;animation&quot;];//用来删



基本几种方法就是这样然后有一点小技巧
在正常的addsubView等方法使用动画CATransition的动画是安全没有问题的、可是如果你使用presentModalViewController等类似的会把之前的清掉的方法时就会出现一个问题、因为前面清掉了所以背景是黑色的、整个动画是做在黑色背景上的非常难看。在不破坏自己原来代码架构的情况下我就想到了一个方法在presentmodalviewController里的animated的参数置为YES然后设置为淡出效果、然后再继续用CATransition、这样相当于同时做两个动画但是那个淡出效果很淡看得很舒服完全是不会影响本来写得动画效果的
</code></pre></div>
<blockquote>
</blockquote>
<div class="highlight"><pre><code class="language-text" data-lang="text">
</code></pre></div>
    </div>

  
    <ul class="tag_box inline">
      <li><i class="icon-folder-open"></i></li>
      
      


  
    
    	<li><a href="#program-ref">
    		program <span>39</span>
    	</a></li>
    
  



    </ul>
  

  
    <ul class="tag_box inline">
      <li><i class="icon-tags"></i></li>
      
      


  
    
  



    </ul>
  
  </div>
</div>


<div class="page-header">
  <h3><a href="/program/2012/11/28/bmp%E3%80%81png%E5%88%9D%E7%90%86%E8%A7%A3">bmp、png初理解 </a></h3>
  <div class="date">
    <span>28 November 2012</span>
  </div>
</div>

<div class="row-fluid post-full">
  <div class="span12">
    <div class="content">
      <p><p>主要还是写下bmp图的操作(另外两个看的实在头大<br />
首先bmp的头是由三部分组成的、分别是位图头、位图信息、调色板<br />
下面就是位图数据了<br />
详见<a href="http://zh.wikipedia.org/zh/BMP#.E8.B0.83.E8.89.B2.E6.9D.BF"><a href="http://zh.wikipedia.org/zh/BMP#.E8.B0.83.E8.89.B2.E6.9D.BF">http://zh.wikipedia.org/zh/BMP#.E8.B0.83.E8.89.B2.E6.9D.BF</a></a>
我用了以下的三个结构体用来接bmp头 然后再一个来接像素数据</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">//
//  BmpLab.h
//  labfor12c
//
//  Created by zxz on 12-11-28.
//  Copyright (c) 2012年 zxz. All rights reserved.
//

#ifndef labfor12c___BmpLab_h
#define labfor12c___BmpLab_h

typedef struct __BitMapHead{
//    __uint16_t fileType;  //default BM
    __uint32_t fileSize;
    __uint32_t unDefined; //undefined
    __uint32_t fileOffset;
}BitMapHead;

typedef struct __BitMapInfo{
    __uint32_t infoHeadSize; //40
    __uint32_t bitMapWidth;
    __uint32_t bitMapHeight;
    __uint16_t bitMapColorPlanes; //彩色位面的个数（不懂
    __uint16_t bitMapPixelBit; //1 4 8 灰阶 24彩
    __uint32_t bitMapCompression; //0 - 没有压缩（也用BI_RGB表示）    1 - 行程长度编码 8位/像素（也用BI_RLE8表示）    2 - 行程长度编码4位/像素（也用BI_RLE4表示）    3 - Bit field（也用BI_BITFIELDS表示）    4 - JPEG图像（也用BI_JPEG表示）    5 - PNG图像（也用BI_PNG表示）
    __uint32_t bitMapBodySize;
    __uint32_t bitMapXPixel;  //水平分辨率
    __uint32_t bitMapYPixel;  //垂直分辨率
    __uint32_t bitMapColorUsed;
    __uint32_t bitMapImportantColorUsed;

}BitMapInfo;

typedef struct __RGBQUARD{
    __uint8_t rgbRed;
    __uint8_t rgbGreen;
    __uint8_t rgbBlue;
    __uint8_t rgbReserved;
}RGBQUARD;

typedef struct __pixelData
{
    __uint8_t blue;
    __uint8_t green;
    __uint8_t red;
}pixelData;
#endif

再然后就是把文件rb打开分别用上面的结构体接就可以了
其中要注意的下因为type是2个字节的、结构体是会补齐的也就是如果直接一起读进去后面都会乱的
所以我把type从结构体里注释了、选择先读进2个字节、然后再一并读进去

//
//  main.c
//  labfor12c
//
//  Created by zxz on 12-11-26.
//  Copyright (c) 2012年 zxz. All rights reserved.
//

#include 
#include 
#include &quot;BmpLab.h&quot;

BitMapHead head;
BitMapInfo info;
RGBQUARD color[256];
int main(int argc, const char * argv[])
{

    FILE *fpr,*fpw;
    fpr=fopen(&quot;test_binaryImg.bmp&quot;, &quot;rb&quot;);
    if (!fpr) {
        printf(&quot;open fail&quot;);
    }
    else
    {
        __uint16_t type;
        fread(&amp;type, 1, sizeof(__uint16_t), fpr);
        if (type!=0x4d42) {
            printf(&quot;not a bmp file&quot;);
            return 1;
        }
        fread(&amp;head, 1, sizeof(BitMapHead), fpr);
        fread(&amp;info, 1, sizeof(BitMapInfo), fpr);
        unsigned int nCounti=0;
        for(nCounti=0;nCounti
        {
            fread((char *)&amp;(color[nCounti].rgbBlue),1,sizeof(__uint8_t),fpr);
            fread((char *)&amp;(color[nCounti].rgbGreen),1,sizeof(__uint8_t),fpr);
            fread((char *)&amp;(color[nCounti].rgbRed),1,sizeof(__uint8_t),fpr);
            fread((char *)&amp;(color[nCounti].rgbReserved),1,sizeof(__uint8_t),fpr);
        }
    }
    __uint8_t *imgdata=(__uint8_t*)malloc(info.bitMapWidth*((sizeof(pixelData)+3)&amp;~4)*info.bitMapHeight); //向4取整（早上学完装逼的方法马上来用……
    fread(imgdata, sizeof(pixelData)*info.bitMapWidth, info.bitMapHeight, fpr);
    //deal with the preix
    return 0;
}


往回保存的时候修改下头里面的数据然后往回写即可

接着是png和jpeg、开始我 以为的是他们和位图一样简单呢……我还是太年轻了……
还是先看下png的头吧
png的头首先是一个8个字节的标示
89 50 4E 47 0D 0A 1A 0A
接下去是4个标准数据块
分别是文件头数据块IHDR(header chunk)：包含有图像基本信息，作为第一个数据块出现并只出现一次。
调色板数据块PLTE(palette chunk)：必须放在图像数据块之前。
图像数据块IDAT(image data chunk)：存储实际图像数据。PNG数据允许包含多个连续的图像数据块。
图像结束数据IEND(image trailer chunk)：放在文件尾部，表示PNG数据流结束。

其中的每个数据块的结构是
Length(长度)  4字节  指定数据块中数据域的长度，其长度不超过(231－1)字节
Chunk Type Code(数据块类型码) 4字节  数据块类型码由ASCII字母(A-Z和a-z)组成
Chunk Data(数据块数据) 可变长度     存储按照Chunk Type Code指定的数据
CRC(循环冗余检测) 4字节  存储用来检测是否有错误的循环冗余码

每块数据块的具体详见http://dev.gameres.com/Program/Visual/Other/PNGFormat.htm
又是CRC什么的一搞就没兴趣去写代码解析了……
原来png jpeg这种头格式上半毛钱都关系不上啊……

&gt;
</code></pre></div>
    </div>

  
    <ul class="tag_box inline">
      <li><i class="icon-folder-open"></i></li>
      
      


  
    
    	<li><a href="#program-ref">
    		program <span>39</span>
    	</a></li>
    
  



    </ul>
  

  
    <ul class="tag_box inline">
      <li><i class="icon-tags"></i></li>
      
      


  
    
  



    </ul>
  
  </div>
</div>


<!-- </ul> -->

<div id="post-pagination" class="paginator">

  
    
    <a href="/page2">前页</a>
    
  

      
      <a href="/">1</a>
      

    
      
      <a href="/page2">2</a>
      
    
      
      <span class="current-page">3</span>
      
    
      
      <a href="/page4">4</a>
      
    
      
      <a href="/page5">5</a>
      
    
      
      <a href="/page6">6</a>
      
    

  
    <a class="next" href="/page4">后页</a>
  
  (共52篇)
</div>

        </div>
        <hr>
        <footer>
          <p>&copy; 2014 Xinzheng ZhangPowered by Jekyll @ GitHub
          </p>
        </footer>

      </div>
    </div>
    
  </body>
</html>

